<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>dowhy.gcm package &mdash; DoWhy | An end-to-end library for causal inference  documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="_static/doctools.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="dowhy.gcm.independence_test package" href="dowhy.gcm.independence_test.html" />
    <link rel="prev" title="dowhy.do_samplers package" href="dowhy.do_samplers.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="index.html" class="icon icon-home"> DoWhy | An end-to-end library for causal inference
          </a>
              <div class="version">
                master
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="getting_started/intro.html">Introduction to DoWhy</a></li>
<li class="toctree-l1"><a class="reference internal" href="getting_started/install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="example_notebooks/dowhy_simple_example.html">Quick-start notebook</a></li>
<li class="toctree-l1"><a class="reference internal" href="getting_started/comparison.html">Comparison to other packages</a></li>
<li class="toctree-l1"><a class="reference internal" href="getting_started/cite.html">Citing this package</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">User Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="user_guide/causality_intro.html">Introduction to causality</a></li>
<li class="toctree-l1"><a class="reference internal" href="user_guide/four_steps_causality.html">Effect inference</a></li>
<li class="toctree-l1"><a class="reference internal" href="example_notebooks/nb_index.html">Example notebooks</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Tutorials/Case studies</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="example_notebooks/tutorial-causalinference-machinelearning-using-dowhy-econml.html">CATE estimation with DoWhy+EconML</a></li>
<li class="toctree-l1"><a class="reference internal" href="example_notebooks/dowhy_example_effect_of_memberrewards_program.html">Effect of membership rewards program</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">GCM-based inference (Experimental)</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="gcm/user_guide/index.html">GCMs User Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="example_notebooks/gcm_basic_example.html">Basic Example for GCM-Based Inference</a></li>
<li class="toctree-l1"><a class="reference internal" href="example_notebooks/rca_microservice_architecture.html">Root cause analysis (RCA) of latencies in a microservice architecture</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Contributing</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="contributing/index.html">Contributing to DoWhy</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Package</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="code_repo.html">Code repository &amp; Versions</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="dowhy.html">dowhy package</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="dowhy.html#subpackages">Subpackages</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="dowhy.api.html">dowhy.api package</a></li>
<li class="toctree-l3"><a class="reference internal" href="dowhy.causal_estimators.html">dowhy.causal_estimators package</a></li>
<li class="toctree-l3"><a class="reference internal" href="dowhy.causal_identifiers.html">dowhy.causal_identifiers package</a></li>
<li class="toctree-l3"><a class="reference internal" href="dowhy.causal_refuters.html">dowhy.causal_refuters package</a></li>
<li class="toctree-l3"><a class="reference internal" href="dowhy.data_transformers.html">dowhy.data_transformers package</a></li>
<li class="toctree-l3"><a class="reference internal" href="dowhy.do_samplers.html">dowhy.do_samplers package</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">dowhy.gcm package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#subpackages">Subpackages</a></li>
<li class="toctree-l4"><a class="reference internal" href="#submodules">Submodules</a></li>
<li class="toctree-l4"><a class="reference internal" href="#module-dowhy.gcm.cms">dowhy.gcm.cms module</a></li>
<li class="toctree-l4"><a class="reference internal" href="#module-dowhy.gcm.config">dowhy.gcm.config module</a></li>
<li class="toctree-l4"><a class="reference internal" href="#module-dowhy.gcm.constant">dowhy.gcm.constant module</a></li>
<li class="toctree-l4"><a class="reference internal" href="#module-dowhy.gcm.distribution_change">dowhy.gcm.distribution_change module</a></li>
<li class="toctree-l4"><a class="reference internal" href="#module-dowhy.gcm.divergence">dowhy.gcm.divergence module</a></li>
<li class="toctree-l4"><a class="reference internal" href="#module-dowhy.gcm.fcms">dowhy.gcm.fcms module</a></li>
<li class="toctree-l4"><a class="reference internal" href="#module-dowhy.gcm.fitting_sampling">dowhy.gcm.fitting_sampling module</a></li>
<li class="toctree-l4"><a class="reference internal" href="#module-dowhy.gcm.graph">dowhy.gcm.graph module</a></li>
<li class="toctree-l4"><a class="reference internal" href="#module-dowhy.gcm.shapley">dowhy.gcm.shapley module</a></li>
<li class="toctree-l4"><a class="reference internal" href="#module-dowhy.gcm.stats">dowhy.gcm.stats module</a></li>
<li class="toctree-l4"><a class="reference internal" href="#module-dowhy.gcm.stochastic_models">dowhy.gcm.stochastic_models module</a></li>
<li class="toctree-l4"><a class="reference internal" href="#module-dowhy.gcm.whatif">dowhy.gcm.whatif module</a></li>
<li class="toctree-l4"><a class="reference internal" href="#module-dowhy.gcm">Module contents</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="dowhy.graph_learners.html">dowhy.graph_learners package</a></li>
<li class="toctree-l3"><a class="reference internal" href="dowhy.interpreters.html">dowhy.interpreters package</a></li>
<li class="toctree-l3"><a class="reference internal" href="dowhy.utils.html">dowhy.utils package</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="dowhy.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="dowhy.html#module-dowhy.causal_estimator">dowhy.causal_estimator module</a></li>
<li class="toctree-l2"><a class="reference internal" href="dowhy.html#module-dowhy.causal_graph">dowhy.causal_graph module</a></li>
<li class="toctree-l2"><a class="reference internal" href="dowhy.html#module-dowhy.causal_identifier">dowhy.causal_identifier module</a></li>
<li class="toctree-l2"><a class="reference internal" href="dowhy.html#module-dowhy.causal_model">dowhy.causal_model module</a></li>
<li class="toctree-l2"><a class="reference internal" href="dowhy.html#module-dowhy.causal_refuter">dowhy.causal_refuter module</a></li>
<li class="toctree-l2"><a class="reference internal" href="dowhy.html#module-dowhy.data_transformer">dowhy.data_transformer module</a></li>
<li class="toctree-l2"><a class="reference internal" href="dowhy.html#module-dowhy.datasets">dowhy.datasets module</a></li>
<li class="toctree-l2"><a class="reference internal" href="dowhy.html#module-dowhy.do_sampler">dowhy.do_sampler module</a></li>
<li class="toctree-l2"><a class="reference internal" href="dowhy.html#module-dowhy.graph_learner">dowhy.graph_learner module</a></li>
<li class="toctree-l2"><a class="reference internal" href="dowhy.html#module-dowhy.interpreter">dowhy.interpreter module</a></li>
<li class="toctree-l2"><a class="reference internal" href="dowhy.html#module-dowhy.plotter">dowhy.plotter module</a></li>
<li class="toctree-l2"><a class="reference internal" href="dowhy.html#module-dowhy">Module contents</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">DoWhy | An end-to-end library for causal inference</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="dowhy.html">dowhy package</a> &raquo;</li>
      <li>dowhy.gcm package</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/dowhy.gcm.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<section id="dowhy-gcm-package">
<h1>dowhy.gcm package<a class="headerlink" href="#dowhy-gcm-package" title="Permalink to this heading"></a></h1>
<section id="subpackages">
<h2>Subpackages<a class="headerlink" href="#subpackages" title="Permalink to this heading"></a></h2>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="dowhy.gcm.independence_test.html">dowhy.gcm.independence_test package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="dowhy.gcm.independence_test.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="dowhy.gcm.independence_test.html#module-dowhy.gcm.independence_test.kernel">dowhy.gcm.independence_test.kernel module</a></li>
<li class="toctree-l2"><a class="reference internal" href="dowhy.gcm.independence_test.html#module-dowhy.gcm.independence_test.kernel_operation">dowhy.gcm.independence_test.kernel_operation module</a></li>
<li class="toctree-l2"><a class="reference internal" href="dowhy.gcm.independence_test.html#module-dowhy.gcm.independence_test">Module contents</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="dowhy.gcm.ml.html">dowhy.gcm.ml package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="dowhy.gcm.ml.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="dowhy.gcm.ml.html#module-dowhy.gcm.ml.classification">dowhy.gcm.ml.classification module</a></li>
<li class="toctree-l2"><a class="reference internal" href="dowhy.gcm.ml.html#module-dowhy.gcm.ml.regression">dowhy.gcm.ml.regression module</a></li>
<li class="toctree-l2"><a class="reference internal" href="dowhy.gcm.ml.html#module-dowhy.gcm.ml">Module contents</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="dowhy.gcm.util.html">dowhy.gcm.util package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="dowhy.gcm.util.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="dowhy.gcm.util.html#module-dowhy.gcm.util.general">dowhy.gcm.util.general module</a></li>
<li class="toctree-l2"><a class="reference internal" href="dowhy.gcm.util.html#module-dowhy.gcm.util">Module contents</a></li>
</ul>
</li>
</ul>
</div>
</section>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this heading"></a></h2>
</section>
<section id="module-dowhy.gcm.cms">
<span id="dowhy-gcm-cms-module"></span><h2>dowhy.gcm.cms module<a class="headerlink" href="#module-dowhy.gcm.cms" title="Permalink to this heading"></a></h2>
<p>This module defines the fundamental classes for graphical causal models (GCMs).</p>
<p>Classes in this module should be considered experimental, meaning there might be breaking API changes in the future.</p>
<dl class="py class">
<dt class="sig sig-object py" id="dowhy.gcm.cms.InvertibleStructuralCausalModel">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dowhy.gcm.cms.</span></span><span class="sig-name descname"><span class="pre">InvertibleStructuralCausalModel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">graph:</span> <span class="pre">~typing.Optional[~dowhy.gcm.graph.DirectedGraph]</span> <span class="pre">=</span> <span class="pre">None,</span> <span class="pre">graph_copier:</span> <span class="pre">~typing.Callable[[~dowhy.gcm.graph.DirectedGraph],</span> <span class="pre">~dowhy.gcm.graph.DirectedGraph]</span> <span class="pre">=</span> <span class="pre">&lt;class</span> <span class="pre">'networkx.classes.digraph.DiGraph'&gt;</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dowhy/gcm/cms.html#InvertibleStructuralCausalModel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.cms.InvertibleStructuralCausalModel" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#dowhy.gcm.cms.StructuralCausalModel" title="dowhy.gcm.cms.StructuralCausalModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">StructuralCausalModel</span></code></a></p>
<p>Represents an invertible structural graphical causal model, as required e.g. by
<a class="reference internal" href="#dowhy.gcm.whatif.counterfactual_samples" title="dowhy.gcm.whatif.counterfactual_samples"><code class="xref py py-func docutils literal notranslate"><span class="pre">counterfactual_samples()</span></code></a>. This is a subclass of
<a class="reference internal" href="#dowhy.gcm.cms.StructuralCausalModel" title="dowhy.gcm.cms.StructuralCausalModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">StructuralCausalModel</span></code></a> and has further restrictions on the class of causal mechanisms.
Here, the mechanisms of non-root nodes need to be invertible with respect to the noise,
such as <a class="reference internal" href="#dowhy.gcm.fcms.PostNonlinearModel" title="dowhy.gcm.fcms.PostNonlinearModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">PostNonlinearModel</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>graph</strong> – Optional graph object to be used as causal graph.</p></li>
<li><p><strong>graph_copier</strong> – Optional function that can copy a causal graph. Defaults to a networkx.DiGraph
constructor.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="dowhy.gcm.cms.InvertibleStructuralCausalModel.causal_mechanism">
<span class="sig-name descname"><span class="pre">causal_mechanism</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">node</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#dowhy.gcm.graph.StochasticModel" title="dowhy.gcm.graph.StochasticModel"><span class="pre">StochasticModel</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#dowhy.gcm.graph.InvertibleFunctionalCausalModel" title="dowhy.gcm.graph.InvertibleFunctionalCausalModel"><span class="pre">InvertibleFunctionalCausalModel</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/dowhy/gcm/cms.html#InvertibleStructuralCausalModel.causal_mechanism"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.cms.InvertibleStructuralCausalModel.causal_mechanism" title="Permalink to this definition"></a></dt>
<dd><p>Returns the generative causal model of node in the causal graph.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>node</strong> – Target node whose causal model is to be assigned.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The causal mechanism for this node. A root node is of type
<a class="reference internal" href="#dowhy.gcm.graph.StochasticModel" title="dowhy.gcm.graph.StochasticModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">StochasticModel</span></code></a>, whereas a non-root node is of type
<a class="reference internal" href="#dowhy.gcm.graph.ConditionalStochasticModel" title="dowhy.gcm.graph.ConditionalStochasticModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">ConditionalStochasticModel</span></code></a>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dowhy.gcm.cms.InvertibleStructuralCausalModel.set_causal_mechanism">
<span class="sig-name descname"><span class="pre">set_causal_mechanism</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">target_node</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mechanism</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#dowhy.gcm.graph.StochasticModel" title="dowhy.gcm.graph.StochasticModel"><span class="pre">StochasticModel</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#dowhy.gcm.graph.InvertibleFunctionalCausalModel" title="dowhy.gcm.graph.InvertibleFunctionalCausalModel"><span class="pre">InvertibleFunctionalCausalModel</span></a><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/cms.html#InvertibleStructuralCausalModel.set_causal_mechanism"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.cms.InvertibleStructuralCausalModel.set_causal_mechanism" title="Permalink to this definition"></a></dt>
<dd><p>Assigns the generative causal model of node in the causal graph.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>node</strong> – Target node whose causal model is to be assigned.</p></li>
<li><p><strong>mechanism</strong> – Causal mechanism to be assigned. A root node must be a
<a class="reference internal" href="#dowhy.gcm.graph.StochasticModel" title="dowhy.gcm.graph.StochasticModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">StochasticModel</span></code></a>, whereas a non-root node must be a
<a class="reference internal" href="#dowhy.gcm.graph.ConditionalStochasticModel" title="dowhy.gcm.graph.ConditionalStochasticModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">ConditionalStochasticModel</span></code></a>.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="dowhy.gcm.cms.ProbabilisticCausalModel">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dowhy.gcm.cms.</span></span><span class="sig-name descname"><span class="pre">ProbabilisticCausalModel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">graph:</span> <span class="pre">~typing.Optional[~dowhy.gcm.graph.DirectedGraph]</span> <span class="pre">=</span> <span class="pre">None,</span> <span class="pre">graph_copier:</span> <span class="pre">~typing.Callable[[~dowhy.gcm.graph.DirectedGraph],</span> <span class="pre">~dowhy.gcm.graph.DirectedGraph]</span> <span class="pre">=</span> <span class="pre">&lt;class</span> <span class="pre">'networkx.classes.digraph.DiGraph'&gt;</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dowhy/gcm/cms.html#ProbabilisticCausalModel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.cms.ProbabilisticCausalModel" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Represents a probabilistic graphical causal model, i.e. it combines a graphical representation of causal
causal relationships and corresponding causal mechanism for each node describing the data generation process. The
causal mechanisms can be any general stochastic models.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>graph</strong> – Optional graph object to be used as causal graph.</p></li>
<li><p><strong>graph_copier</strong> – Optional function that can copy a causal graph. Defaults to a networkx.DiGraph
constructor.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="dowhy.gcm.cms.ProbabilisticCausalModel.causal_mechanism">
<span class="sig-name descname"><span class="pre">causal_mechanism</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">node</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#dowhy.gcm.graph.StochasticModel" title="dowhy.gcm.graph.StochasticModel"><span class="pre">StochasticModel</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#dowhy.gcm.graph.ConditionalStochasticModel" title="dowhy.gcm.graph.ConditionalStochasticModel"><span class="pre">ConditionalStochasticModel</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/dowhy/gcm/cms.html#ProbabilisticCausalModel.causal_mechanism"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.cms.ProbabilisticCausalModel.causal_mechanism" title="Permalink to this definition"></a></dt>
<dd><p>Returns the generative causal model of node in the causal graph.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>node</strong> – Target node whose causal model is to be assigned.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The causal mechanism for this node. A root node is of type
<a class="reference internal" href="#dowhy.gcm.graph.StochasticModel" title="dowhy.gcm.graph.StochasticModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">StochasticModel</span></code></a>, whereas a non-root node is of type
<a class="reference internal" href="#dowhy.gcm.graph.ConditionalStochasticModel" title="dowhy.gcm.graph.ConditionalStochasticModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">ConditionalStochasticModel</span></code></a>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dowhy.gcm.cms.ProbabilisticCausalModel.clone">
<span class="sig-name descname"><span class="pre">clone</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/dowhy/gcm/cms.html#ProbabilisticCausalModel.clone"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.cms.ProbabilisticCausalModel.clone" title="Permalink to this definition"></a></dt>
<dd><p>Clones the causal model, but keeps causal mechanisms untrained.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dowhy.gcm.cms.ProbabilisticCausalModel.set_causal_mechanism">
<span class="sig-name descname"><span class="pre">set_causal_mechanism</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">node</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mechanism</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#dowhy.gcm.graph.StochasticModel" title="dowhy.gcm.graph.StochasticModel"><span class="pre">StochasticModel</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#dowhy.gcm.graph.ConditionalStochasticModel" title="dowhy.gcm.graph.ConditionalStochasticModel"><span class="pre">ConditionalStochasticModel</span></a><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/cms.html#ProbabilisticCausalModel.set_causal_mechanism"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.cms.ProbabilisticCausalModel.set_causal_mechanism" title="Permalink to this definition"></a></dt>
<dd><p>Assigns the generative causal model of node in the causal graph.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>node</strong> – Target node whose causal model is to be assigned.</p></li>
<li><p><strong>mechanism</strong> – Causal mechanism to be assigned. A root node must be a
<a class="reference internal" href="#dowhy.gcm.graph.StochasticModel" title="dowhy.gcm.graph.StochasticModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">StochasticModel</span></code></a>, whereas a non-root node must be a
<a class="reference internal" href="#dowhy.gcm.graph.ConditionalStochasticModel" title="dowhy.gcm.graph.ConditionalStochasticModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">ConditionalStochasticModel</span></code></a>.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="dowhy.gcm.cms.StructuralCausalModel">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dowhy.gcm.cms.</span></span><span class="sig-name descname"><span class="pre">StructuralCausalModel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">graph:</span> <span class="pre">~typing.Optional[~dowhy.gcm.graph.DirectedGraph]</span> <span class="pre">=</span> <span class="pre">None,</span> <span class="pre">graph_copier:</span> <span class="pre">~typing.Callable[[~dowhy.gcm.graph.DirectedGraph],</span> <span class="pre">~dowhy.gcm.graph.DirectedGraph]</span> <span class="pre">=</span> <span class="pre">&lt;class</span> <span class="pre">'networkx.classes.digraph.DiGraph'&gt;</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dowhy/gcm/cms.html#StructuralCausalModel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.cms.StructuralCausalModel" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#dowhy.gcm.cms.ProbabilisticCausalModel" title="dowhy.gcm.cms.ProbabilisticCausalModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">ProbabilisticCausalModel</span></code></a></p>
<p>Represents a structural causal model (SCM), as required e.g. by
<a class="reference internal" href="#dowhy.gcm.whatif.counterfactual_samples" title="dowhy.gcm.whatif.counterfactual_samples"><code class="xref py py-func docutils literal notranslate"><span class="pre">counterfactual_samples()</span></code></a>. As compared to a <a class="reference internal" href="#dowhy.gcm.cms.ProbabilisticCausalModel" title="dowhy.gcm.cms.ProbabilisticCausalModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">ProbabilisticCausalModel</span></code></a>,
an SCM describes the data generation process in non-root nodes by functional causal models.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>graph</strong> – Optional graph object to be used as causal graph.</p></li>
<li><p><strong>graph_copier</strong> – Optional function that can copy a causal graph. Defaults to a networkx.DiGraph
constructor.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="dowhy.gcm.cms.StructuralCausalModel.causal_mechanism">
<span class="sig-name descname"><span class="pre">causal_mechanism</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">node</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#dowhy.gcm.graph.StochasticModel" title="dowhy.gcm.graph.StochasticModel"><span class="pre">StochasticModel</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#dowhy.gcm.graph.FunctionalCausalModel" title="dowhy.gcm.graph.FunctionalCausalModel"><span class="pre">FunctionalCausalModel</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/dowhy/gcm/cms.html#StructuralCausalModel.causal_mechanism"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.cms.StructuralCausalModel.causal_mechanism" title="Permalink to this definition"></a></dt>
<dd><p>Returns the generative causal model of node in the causal graph.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>node</strong> – Target node whose causal model is to be assigned.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The causal mechanism for this node. A root node is of type
<a class="reference internal" href="#dowhy.gcm.graph.StochasticModel" title="dowhy.gcm.graph.StochasticModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">StochasticModel</span></code></a>, whereas a non-root node is of type
<a class="reference internal" href="#dowhy.gcm.graph.ConditionalStochasticModel" title="dowhy.gcm.graph.ConditionalStochasticModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">ConditionalStochasticModel</span></code></a>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dowhy.gcm.cms.StructuralCausalModel.set_causal_mechanism">
<span class="sig-name descname"><span class="pre">set_causal_mechanism</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">node</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mechanism</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#dowhy.gcm.graph.StochasticModel" title="dowhy.gcm.graph.StochasticModel"><span class="pre">StochasticModel</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#dowhy.gcm.graph.FunctionalCausalModel" title="dowhy.gcm.graph.FunctionalCausalModel"><span class="pre">FunctionalCausalModel</span></a><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/cms.html#StructuralCausalModel.set_causal_mechanism"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.cms.StructuralCausalModel.set_causal_mechanism" title="Permalink to this definition"></a></dt>
<dd><p>Assigns the generative causal model of node in the causal graph.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>node</strong> – Target node whose causal model is to be assigned.</p></li>
<li><p><strong>mechanism</strong> – Causal mechanism to be assigned. A root node must be a
<a class="reference internal" href="#dowhy.gcm.graph.StochasticModel" title="dowhy.gcm.graph.StochasticModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">StochasticModel</span></code></a>, whereas a non-root node must be a
<a class="reference internal" href="#dowhy.gcm.graph.ConditionalStochasticModel" title="dowhy.gcm.graph.ConditionalStochasticModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">ConditionalStochasticModel</span></code></a>.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-dowhy.gcm.config">
<span id="dowhy-gcm-config-module"></span><h2>dowhy.gcm.config module<a class="headerlink" href="#module-dowhy.gcm.config" title="Permalink to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="dowhy.gcm.config.disable_progress_bars">
<span class="sig-prename descclassname"><span class="pre">dowhy.gcm.config.</span></span><span class="sig-name descname"><span class="pre">disable_progress_bars</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/dowhy/gcm/config.html#disable_progress_bars"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.config.disable_progress_bars" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dowhy.gcm.config.enable_progress_bars">
<span class="sig-prename descclassname"><span class="pre">dowhy.gcm.config.</span></span><span class="sig-name descname"><span class="pre">enable_progress_bars</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/dowhy/gcm/config.html#enable_progress_bars"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.config.enable_progress_bars" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dowhy.gcm.config.set_default_n_jobs">
<span class="sig-prename descclassname"><span class="pre">dowhy.gcm.config.</span></span><span class="sig-name descname"><span class="pre">set_default_n_jobs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_jobs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/config.html#set_default_n_jobs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.config.set_default_n_jobs" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</section>
<section id="module-dowhy.gcm.constant">
<span id="dowhy-gcm-constant-module"></span><h2>dowhy.gcm.constant module<a class="headerlink" href="#module-dowhy.gcm.constant" title="Permalink to this heading"></a></h2>
</section>
<section id="module-dowhy.gcm.distribution_change">
<span id="dowhy-gcm-distribution-change-module"></span><h2>dowhy.gcm.distribution_change module<a class="headerlink" href="#module-dowhy.gcm.distribution_change" title="Permalink to this heading"></a></h2>
<p>This module defines functions to attribute distribution changes.</p>
<p>Functions in this module should be considered experimental, meaning there might be breaking API changes in the future.</p>
<dl class="py function">
<dt class="sig sig-object py" id="dowhy.gcm.distribution_change.distribution_change">
<span class="sig-prename descclassname"><span class="pre">dowhy.gcm.distribution_change.</span></span><span class="sig-name descname"><span class="pre">distribution_change</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">causal_model:</span> <span class="pre">~dowhy.gcm.cms.ProbabilisticCausalModel,</span> <span class="pre">old_data:</span> <span class="pre">~pandas.core.frame.DataFrame,</span> <span class="pre">new_data:</span> <span class="pre">~pandas.core.frame.DataFrame,</span> <span class="pre">target_node:</span> <span class="pre">~typing.Any,</span> <span class="pre">num_samples:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">2000,</span> <span class="pre">difference_estimation_func:</span> <span class="pre">~typing.Callable[[~numpy.ndarray,</span> <span class="pre">~numpy.ndarray],</span> <span class="pre">float]</span> <span class="pre">=</span> <span class="pre">&lt;function</span> <span class="pre">auto_estimate_kl_divergence&gt;,</span> <span class="pre">mechanism_change_test_func:</span> <span class="pre">~typing.Callable[[~numpy.ndarray,</span> <span class="pre">~numpy.ndarray,</span> <span class="pre">~typing.Optional[~numpy.ndarray],</span> <span class="pre">~typing.Optional[~numpy.ndarray]],</span> <span class="pre">float]</span> <span class="pre">=</span> <span class="pre">&lt;function</span> <span class="pre">mechanism_change_test&gt;,</span> <span class="pre">mechanism_change_test_significance_level:</span> <span class="pre">float</span> <span class="pre">=</span> <span class="pre">0.05,</span> <span class="pre">mechanism_change_test_fdr_control_method:</span> <span class="pre">~typing.Optional[str]</span> <span class="pre">=</span> <span class="pre">'fdr_bh',</span> <span class="pre">return_additional_info:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">False,</span> <span class="pre">shapley_config:</span> <span class="pre">~typing.Optional[~dowhy.gcm.shapley.ShapleyConfig]</span> <span class="pre">=</span> <span class="pre">None,</span> <span class="pre">graph_factory:</span> <span class="pre">~typing.Callable[[~typing.Any],</span> <span class="pre">~dowhy.gcm.graph.DirectedGraph]</span> <span class="pre">=</span> <span class="pre">&lt;class</span> <span class="pre">'networkx.classes.digraph.DiGraph'&gt;</span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">bool</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#dowhy.gcm.cms.ProbabilisticCausalModel" title="dowhy.gcm.cms.ProbabilisticCausalModel"><span class="pre">ProbabilisticCausalModel</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#dowhy.gcm.cms.ProbabilisticCausalModel" title="dowhy.gcm.cms.ProbabilisticCausalModel"><span class="pre">ProbabilisticCausalModel</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/dowhy/gcm/distribution_change.html#distribution_change"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.distribution_change.distribution_change" title="Permalink to this definition"></a></dt>
<dd><p>Attributes the change in the marginal distribution of the target_node to nodes upstream in the causal DAG.</p>
<p>Note that this method creates two copies of the causal DAG. The causal models of one causal DAG are learned from
old data and those of another DAG are learned from new data.</p>
<p><strong>Research Paper</strong>:
Kailash Budhathoki, Dominik Janzing, Patrick Bloebaum, Hoiyi Ng. <em>Why did the distribution change?</em>. Proceedings
of The 24th International Conference on Artificial Intelligence and Statistics, PMLR 130:1666-1674, 2021.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>causal_model</strong> – Reference causal model.</p></li>
<li><p><strong>old_data</strong> – Joint samples from the ‘old’ distribution.</p></li>
<li><p><strong>new_data</strong> – Joint samples from the ‘new’ distribution.</p></li>
<li><p><strong>target_node</strong> – Target node of interest for attributing the marginal distribution change.</p></li>
<li><p><strong>num_samples</strong> – Number of samples used for estimating Shapley values. This can have a significant influence
on runtime and accuracy.</p></li>
<li><p><strong>difference_estimation_func</strong> – Function for quantifying the distribution change. This function should expect
two inputs which represent samples from two different distributions,
e.g. difference in average values.</p></li>
<li><p><strong>mechanism_change_test_func</strong> – Function for testing whether the causal mechanism of a node has changed. This
function should return a p–value for the null hypothesis that the mechanism has
not changed.</p></li>
<li><p><strong>mechanism_change_test_significance_level</strong> – A significance level for rejecting the null hypothesis that the
causal mechanism of a node has not changed.</p></li>
<li><p><strong>mechanism_change_test_fdr_control_method</strong> – The false discovery rate control method for mechanism change
tests. For more options, checkout <a class="reference external" href="https://www.statsmodels.org/dev/generated/statsmodels.stats.multitest.multipletests.html">statsmodels manual</a>.</p></li>
<li><p><strong>return_additional_info</strong> – If set to True, three additional items are returned: a dictionary indicating
whether each node’s mechanism changed, the causal DAG whose causal models are
learned from old data, and the causal DAG whose causal models are learned from new
data.</p></li>
<li><p><strong>shapley_config</strong> – Configuration for the Shapley estimator.</p></li>
<li><p><strong>graph_factory</strong> – Allows customization in case a graph class different than networkx.DiGraph should be used.
This function <em>must</em> copy nodes and edges. Attributes of nodes will be overridden in the copy,
so the algorithm is independent of the attribute copy behavior of this factory.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>By default, if <cite>return_additional_info</cite> is set to False, only the dictionary containing contribution of
each upstream node is returned. If <cite>return_additional_info</cite> is set to True, three additional items are
returned: a dictionary indicating whether each node’s mechanism changed, the causal DAG whose causal models
learned from old data, and the causal DAG whose causal models are learned from new data.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dowhy.gcm.distribution_change.distribution_change_of_graphs">
<span class="sig-prename descclassname"><span class="pre">dowhy.gcm.distribution_change.</span></span><span class="sig-name descname"><span class="pre">distribution_change_of_graphs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">causal_model_old:</span> <span class="pre">~dowhy.gcm.cms.ProbabilisticCausalModel,</span> <span class="pre">causal_model_new:</span> <span class="pre">~dowhy.gcm.cms.ProbabilisticCausalModel,</span> <span class="pre">target_node:</span> <span class="pre">~typing.Any,</span> <span class="pre">num_samples:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">2000,</span> <span class="pre">difference_estimation_func:</span> <span class="pre">~typing.Callable[[~numpy.ndarray,</span> <span class="pre">~numpy.ndarray],</span> <span class="pre">float]</span> <span class="pre">=</span> <span class="pre">&lt;function</span> <span class="pre">auto_estimate_kl_divergence&gt;,</span> <span class="pre">shapley_config:</span> <span class="pre">~typing.Optional[~dowhy.gcm.shapley.ShapleyConfig]</span> <span class="pre">=</span> <span class="pre">None,</span> <span class="pre">graph_factory:</span> <span class="pre">~typing.Callable[[~typing.Any],</span> <span class="pre">~dowhy.gcm.graph.DirectedGraph]</span> <span class="pre">=</span> <span class="pre">&lt;class</span> <span class="pre">'networkx.classes.digraph.DiGraph'&gt;</span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/dowhy/gcm/distribution_change.html#distribution_change_of_graphs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.distribution_change.distribution_change_of_graphs" title="Permalink to this definition"></a></dt>
<dd><p>Attributes the change of the marginal distribution of target_node to upstream nodes based on the distributions
generated by the ‘old’ and ‘new’ causal graphs. These graphs are assumed to represent the same causal structure and
to be fitted on the respective data.</p>
<p>Note: This method creates a copy of the given causal models, i.e. the original objects will not be modified.</p>
<p>Related paper:
Budhathoki, K., Janzing, D., Bloebaum, P., &amp; Ng, H. (2021). Why did the distribution change?
arXiv preprint arXiv:2102.13384.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>causal_model_old</strong> – The ProbabilisticCausalModel fitted on the ‘old’ data.</p></li>
<li><p><strong>causal_model_new</strong> – The ProbabilisticCausalModel fitted on the ‘new’ data.</p></li>
<li><p><strong>target_node</strong> – Node of interest for attributing the marginal distribution change.</p></li>
<li><p><strong>num_samples</strong> – Number of samples used for the estimation. This can have a significant influence on the runtime
and accuracy.</p></li>
<li><p><strong>difference_estimation_func</strong> – Function for quantifying the distribution change. This function should expect
two inputs which represent samples from two different distributions. An example
could be the KL divergence.</p></li>
<li><p><strong>shapley_config</strong> – Config for the Shapley estimator.</p></li>
<li><p><strong>graph_factory</strong> – Allows customization in case a graph class different than networkx.DiGraph should be used.
This function <em>must</em> copy nodes and edges. Attributes of nodes will be overridden in the copy,
so the algorithm is independent of the attribute copy behavior of this factory.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A dictionary containing the contributions of upstream nodes to the marginal distribution change in the
target node.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dowhy.gcm.distribution_change.estimate_distribution_change_scores">
<span class="sig-prename descclassname"><span class="pre">dowhy.gcm.distribution_change.</span></span><span class="sig-name descname"><span class="pre">estimate_distribution_change_scores</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">causal_model:</span> <span class="pre">~dowhy.gcm.cms.ProbabilisticCausalModel,</span> <span class="pre">original_data:</span> <span class="pre">~pandas.core.frame.DataFrame,</span> <span class="pre">new_data:</span> <span class="pre">~pandas.core.frame.DataFrame,</span> <span class="pre">difference_estimation_func:</span> <span class="pre">~typing.Callable[[~numpy.ndarray,</span> <span class="pre">~numpy.ndarray],</span> <span class="pre">~typing.Union[~numpy.ndarray,</span> <span class="pre">float]]</span> <span class="pre">=</span> <span class="pre">&lt;function</span> <span class="pre">auto_estimate_kl_divergence&gt;,</span> <span class="pre">max_num_evaluation_samples:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">1000,</span> <span class="pre">num_joint_samples:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">500,</span> <span class="pre">early_stopping_percentage:</span> <span class="pre">float</span> <span class="pre">=</span> <span class="pre">0.01,</span> <span class="pre">mechanism_change_test_func:</span> <span class="pre">~typing.Callable[[~numpy.ndarray,</span> <span class="pre">~numpy.ndarray,</span> <span class="pre">~typing.Optional[~numpy.ndarray],</span> <span class="pre">~typing.Optional[~numpy.ndarray]],</span> <span class="pre">float]</span> <span class="pre">=</span> <span class="pre">&lt;function</span> <span class="pre">mechanism_change_test&gt;,</span> <span class="pre">mechanism_change_test_significance_level:</span> <span class="pre">float</span> <span class="pre">=</span> <span class="pre">0.05,</span> <span class="pre">mechanism_change_test_fdr_control_method:</span> <span class="pre">~typing.Optional[str]</span> <span class="pre">=</span> <span class="pre">'fdr_bh'</span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/dowhy/gcm/distribution_change.html#estimate_distribution_change_scores"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.distribution_change.estimate_distribution_change_scores" title="Permalink to this definition"></a></dt>
<dd><p>Given newly observed and original samples from the joint distribution of the given causal graphical model, this
method estimates a score for each node that quantifies how much the distribution of the node has changed. For this,
it first checks whether the underlying causal mechanism has changed at all and, if this is the case, it estimates
the difference between the new and original distributions. The score is based on the quantity measured by the
provided difference_estimation_func or 0 if no mechanism change has been detected.</p>
<p>Note that for each parent sample, num_joint_samples conditional samples are generated based on the original and new
causal mechanism and evaluated by the given difference_estimation_func function. These results are then averaged
over multiple different parent samples.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>causal_model</strong> – The underlying causal model based on the original data.</p></li>
<li><p><strong>original_data</strong> – Samples from the original data.</p></li>
<li><p><strong>new_data</strong> – Samples from the new data.</p></li>
<li><p><strong>difference_estimation_func</strong> – Function for quantifying the distribution change. This function should expect
two inputs which represent samples from two different distributions. An example
could be the KL divergence.</p></li>
<li><p><strong>max_num_evaluation_samples</strong> – Maximum number of (parent) samples for evaluating the difference in
distributions.</p></li>
<li><p><strong>num_joint_samples</strong> – Number of samples generated in a node per parent sample.</p></li>
<li><p><strong>early_stopping_percentage</strong> – If the change in percentage between multiple consecutive runs is below this
threshold, the evaluation stops before evaluating all max_num_evaluation_samples.</p></li>
<li><p><strong>mechanism_change_test_func</strong> – Function for testing whether the causal mechanism of a node has changed. This
function should return a p–value for the null hypothesis that the mechanism has
not changed.</p></li>
<li><p><strong>mechanism_change_test_significance_level</strong> – A significance level for rejecting the null hypothesis that the
causal mechanism of a node has not changed.</p></li>
<li><p><strong>mechanism_change_test_fdr_control_method</strong> – <p>The false discovery rate control method for mechanism change
tests. For more options, checkout <a class="reference external" href="https://www.statsmodels.org/dev/generated/statsmodels.stats.multitest.multipletests.html">statsmodels manual</a>.</p>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A dictionary assining a score to each node in the causal graph.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dowhy.gcm.distribution_change.mechanism_change_test">
<span class="sig-prename descclassname"><span class="pre">dowhy.gcm.distribution_change.</span></span><span class="sig-name descname"><span class="pre">mechanism_change_test</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">target_original_data:</span> <span class="pre">~numpy.ndarray,</span> <span class="pre">target_new_data:</span> <span class="pre">~numpy.ndarray,</span> <span class="pre">parents_original_data:</span> <span class="pre">~typing.Optional[~numpy.ndarray]</span> <span class="pre">=</span> <span class="pre">None,</span> <span class="pre">parents_new_data:</span> <span class="pre">~typing.Optional[~numpy.ndarray]</span> <span class="pre">=</span> <span class="pre">None,</span> <span class="pre">independence_test:</span> <span class="pre">~typing.Union[~typing.Callable[[~numpy.ndarray,</span> <span class="pre">~numpy.ndarray],</span> <span class="pre">float],</span> <span class="pre">~typing.Callable[[~numpy.ndarray,</span> <span class="pre">~numpy.ndarray,</span> <span class="pre">~numpy.ndarray],</span> <span class="pre">float]]</span> <span class="pre">=</span> <span class="pre">&lt;function</span> <span class="pre">kernel_based&gt;</span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/distribution_change.html#mechanism_change_test"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.distribution_change.mechanism_change_test" title="Permalink to this definition"></a></dt>
<dd><p>Estimates a p-value for the nullhypothesis that the original and new data were generated by the same mechanism. 
Here, we check the dependency between binary labels indicating whether a sample is from the original or a new 
data set. If the labels do not provide information to determine if a sample is coming from the original/new 
distribution, then it is likely that the mechanism has not changed.</p>
<p>For non-root nodes, samples from parent variables are needed as conditioning variables. This is, testing the
nullhypothesis that the data were generated by the same mechanism given the parent samples. By this, we incorporate
upstream changes that might have impacted the parents, but not the target node itself.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>target_original_data</strong> – Samples of the node from the original data set.</p></li>
<li><p><strong>target_new_data</strong> – Samples of the node from the new data set.</p></li>
<li><p><strong>parents_original_data</strong> – Samples from parents of the node from the original data set.</p></li>
<li><p><strong>parents_new_data</strong> – Samples from parents of the node from the new data set.</p></li>
<li><p><strong>independence_test</strong> – Pairwise/conditional independence test.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A p-value for the nullhypothesis that the mechanism has not changed.</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-dowhy.gcm.divergence">
<span id="dowhy-gcm-divergence-module"></span><h2>dowhy.gcm.divergence module<a class="headerlink" href="#module-dowhy.gcm.divergence" title="Permalink to this heading"></a></h2>
<p>Functions in this module should be considered experimental, meaning there might be breaking API changes in the
future.</p>
<dl class="py function">
<dt class="sig sig-object py" id="dowhy.gcm.divergence.auto_estimate_kl_divergence">
<span class="sig-prename descclassname"><span class="pre">dowhy.gcm.divergence.</span></span><span class="sig-name descname"><span class="pre">auto_estimate_kl_divergence</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/divergence.html#auto_estimate_kl_divergence"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.divergence.auto_estimate_kl_divergence" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dowhy.gcm.divergence.estimate_kl_divergence_categorical">
<span class="sig-prename descclassname"><span class="pre">dowhy.gcm.divergence.</span></span><span class="sig-name descname"><span class="pre">estimate_kl_divergence_categorical</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/divergence.html#estimate_kl_divergence_categorical"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.divergence.estimate_kl_divergence_categorical" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dowhy.gcm.divergence.estimate_kl_divergence_continuous">
<span class="sig-prename descclassname"><span class="pre">dowhy.gcm.divergence.</span></span><span class="sig-name descname"><span class="pre">estimate_kl_divergence_continuous</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/divergence.html#estimate_kl_divergence_continuous"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.divergence.estimate_kl_divergence_continuous" title="Permalink to this definition"></a></dt>
<dd><p>Estimates KL-Divergence using k-nearest neighbours (Wang et al., 2009).</p>
<p>Q. Wang, S. R. Kulkarni, and S. Verdú,
“Divergence estimation for multidimensional densities via k-nearest-neighbor distances”,
IEEE Transactions on Information Theory, vol. 55, no. 5, pp. 2392-2405, May 2009.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> – (N_1,D) Sample drawn from distribution P_X</p></li>
<li><p><strong>Y</strong> – (N_2,D) Sample drawn from distribution P_Y</p></li>
</ul>
</dd>
</dl>
<p>return: Estimated value of D(P_X||P_Y).</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dowhy.gcm.divergence.estimate_kl_divergence_of_probabilities">
<span class="sig-prename descclassname"><span class="pre">dowhy.gcm.divergence.</span></span><span class="sig-name descname"><span class="pre">estimate_kl_divergence_of_probabilities</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/divergence.html#estimate_kl_divergence_of_probabilities"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.divergence.estimate_kl_divergence_of_probabilities" title="Permalink to this definition"></a></dt>
<dd><p>Estimates the Kullback-Leibler divergence between each pair of probability vectors (row wise) in X and Y
separately and returns the mean over all results.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dowhy.gcm.divergence.is_probability_matrix">
<span class="sig-prename descclassname"><span class="pre">dowhy.gcm.divergence.</span></span><span class="sig-name descname"><span class="pre">is_probability_matrix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">bool</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/divergence.html#is_probability_matrix"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.divergence.is_probability_matrix" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</section>
<section id="module-dowhy.gcm.fcms">
<span id="dowhy-gcm-fcms-module"></span><h2>dowhy.gcm.fcms module<a class="headerlink" href="#module-dowhy.gcm.fcms" title="Permalink to this heading"></a></h2>
<p>This module defines multiple implementations of the abstract class <a class="reference internal" href="#dowhy.gcm.graph.FunctionalCausalModel" title="dowhy.gcm.graph.FunctionalCausalModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">FunctionalCausalModel</span></code></a>
(FCM)</p>
<p>Classes in this module should be considered experimental, meaning there might be breaking API changes in the future.</p>
<dl class="py class">
<dt class="sig sig-object py" id="dowhy.gcm.fcms.AdditiveNoiseModel">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dowhy.gcm.fcms.</span></span><span class="sig-name descname"><span class="pre">AdditiveNoiseModel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">prediction_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#dowhy.gcm.fcms.PredictionModel" title="dowhy.gcm.fcms.PredictionModel"><span class="pre">PredictionModel</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">noise_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#dowhy.gcm.graph.StochasticModel" title="dowhy.gcm.graph.StochasticModel"><span class="pre">StochasticModel</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dowhy/gcm/fcms.html#AdditiveNoiseModel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.fcms.AdditiveNoiseModel" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#dowhy.gcm.fcms.PostNonlinearModel" title="dowhy.gcm.fcms.PostNonlinearModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">PostNonlinearModel</span></code></a></p>
<dl class="simple">
<dt>Represents the continuous functional causal model of the form</dt><dd><p>Y = f(X) + N,</p>
</dd>
</dl>
<p>where X is the input (typically, direct causal parents of Y) and the noise N is assumed to be independent of X. This
is a special instance of a <code class="xref py py-class docutils literal notranslate"><span class="pre">PostNonlinearModel</span></code> where the function g is the
identity function.</p>
<p>Given joint samples from (X, Y), this model can be fitted by first training a model f (e.g. using least squares
regression) and then reconstruct N by N = Y - f(X), i.e. using the residual.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>prediction_model</strong> – The prediction model f.</p></li>
<li><p><strong>invertible_function</strong> – The invertible function g.</p></li>
<li><p><strong>noise_model</strong> – The StochasticModel to describe the distribution of the noise N.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="dowhy.gcm.fcms.AdditiveNoiseModel.clone">
<span class="sig-name descname"><span class="pre">clone</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/dowhy/gcm/fcms.html#AdditiveNoiseModel.clone"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.fcms.AdditiveNoiseModel.clone" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="dowhy.gcm.fcms.ClassificationModel">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dowhy.gcm.fcms.</span></span><span class="sig-name descname"><span class="pre">ClassificationModel</span></span><a class="reference internal" href="_modules/dowhy/gcm/fcms.html#ClassificationModel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.fcms.ClassificationModel" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#dowhy.gcm.fcms.PredictionModel" title="dowhy.gcm.fcms.PredictionModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">PredictionModel</span></code></a></p>
<dl class="py property">
<dt class="sig sig-object py" id="dowhy.gcm.fcms.ClassificationModel.classes">
<em class="property"><span class="pre">abstract</span><span class="w"> </span><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">classes</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#dowhy.gcm.fcms.ClassificationModel.classes" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dowhy.gcm.fcms.ClassificationModel.predict_probabilities">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">predict_probabilities</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">array</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/fcms.html#ClassificationModel.predict_probabilities"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.fcms.ClassificationModel.predict_probabilities" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="dowhy.gcm.fcms.ClassifierFCM">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dowhy.gcm.fcms.</span></span><span class="sig-name descname"><span class="pre">ClassifierFCM</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">classifier_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#dowhy.gcm.fcms.ClassificationModel" title="dowhy.gcm.fcms.ClassificationModel"><span class="pre">ClassificationModel</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dowhy/gcm/fcms.html#ClassifierFCM"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.fcms.ClassifierFCM" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#dowhy.gcm.graph.FunctionalCausalModel" title="dowhy.gcm.graph.FunctionalCausalModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">FunctionalCausalModel</span></code></a>, <a class="reference internal" href="#dowhy.gcm.fcms.ProbabilityEstimatorModel" title="dowhy.gcm.fcms.ProbabilityEstimatorModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">ProbabilityEstimatorModel</span></code></a></p>
<dl class="simple">
<dt>Represents the categorical functional causal model of the form</dt><dd><p>Y = f(X, N),</p>
</dd>
</dl>
<p>where X is the input (typically, direct causal parents of Y) and the noise N here is uniform on [0, 1]. The model
is mostly based on a standard classification model that outputs probabilities. In order to generate a new random
sample given an input x, the return value y is uniformly sampled based on the class probabilities p(y | x). Here,
the noise is used to make this sampling process deterministic by using the cumulative distribution functions defined
by the given inputs.</p>
<dl class="py property">
<dt class="sig sig-object py" id="dowhy.gcm.fcms.ClassifierFCM.classifier_model">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">classifier_model</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#dowhy.gcm.fcms.ClassificationModel" title="dowhy.gcm.fcms.ClassificationModel"><span class="pre">ClassificationModel</span></a></em><a class="headerlink" href="#dowhy.gcm.fcms.ClassifierFCM.classifier_model" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dowhy.gcm.fcms.ClassifierFCM.clone">
<span class="sig-name descname"><span class="pre">clone</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/dowhy/gcm/fcms.html#ClassifierFCM.clone"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.fcms.ClassifierFCM.clone" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dowhy.gcm.fcms.ClassifierFCM.draw_noise_samples">
<span class="sig-name descname"><span class="pre">draw_noise_samples</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_samples</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/fcms.html#ClassifierFCM.draw_noise_samples"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.fcms.ClassifierFCM.draw_noise_samples" title="Permalink to this definition"></a></dt>
<dd><p>Returns uniformly sampled values on [0, 1].</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>num_samples</strong> – Number of noise samples.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Noise samples on [0, 1].</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dowhy.gcm.fcms.ClassifierFCM.estimate_probabilities">
<span class="sig-name descname"><span class="pre">estimate_probabilities</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">parent_samples</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/fcms.html#ClassifierFCM.estimate_probabilities"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.fcms.ClassifierFCM.estimate_probabilities" title="Permalink to this definition"></a></dt>
<dd><p>Returns the class probabilities for the given parent_samples.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>parent_samples</strong> – Samples from inputs X.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A nxd numpy matrix with class probabilities for each sample, where n is the number of samples and d
the number of classes. Here, array entry A[i][j] corresponds to the i-th sample indicating the
probability of the j-th class.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dowhy.gcm.fcms.ClassifierFCM.evaluate">
<span class="sig-name descname"><span class="pre">evaluate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">parent_samples</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">noise_samples</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/fcms.html#ClassifierFCM.evaluate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.fcms.ClassifierFCM.evaluate" title="Permalink to this definition"></a></dt>
<dd><p>Evaluates the model Y = f(X, N), where X are the parent_samples and N the noise_samples. Here, the
cumulative distribution functions are defined by the parent_samples. For instance, lets say we have 2
classes, n = 0.7 and an input x with p(y = 0| x) = 0.6 and p(y = 1| x) = 0.4, then we get y = 1 as a return
value. This is because p(y = 0| x) &lt; n &lt;= 1.0, i.e. n falls into the bucket that is spanned by p(y = 1| x).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>parent_samples</strong> – Samples from the inputs X.</p></li>
<li><p><strong>noise_samples</strong> – Samples from the noise on [0, 1].</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Class labels Y based on the inputs and noise.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dowhy.gcm.fcms.ClassifierFCM.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/fcms.html#ClassifierFCM.fit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.fcms.ClassifierFCM.fit" title="Permalink to this definition"></a></dt>
<dd><p>Fits the underlying classification model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> – Input samples.</p></li>
<li><p><strong>Y</strong> – Target labels.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dowhy.gcm.fcms.ClassifierFCM.get_class_names">
<span class="sig-name descname"><span class="pre">get_class_names</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">class_indices</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/dowhy/gcm/fcms.html#ClassifierFCM.get_class_names"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.fcms.ClassifierFCM.get_class_names" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="dowhy.gcm.fcms.InvertibleFunction">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dowhy.gcm.fcms.</span></span><span class="sig-name descname"><span class="pre">InvertibleFunction</span></span><a class="reference internal" href="_modules/dowhy/gcm/fcms.html#InvertibleFunction"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.fcms.InvertibleFunction" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="dowhy.gcm.fcms.InvertibleFunction.evaluate">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">evaluate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/fcms.html#InvertibleFunction.evaluate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.fcms.InvertibleFunction.evaluate" title="Permalink to this definition"></a></dt>
<dd><p>Applies the function on the input.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dowhy.gcm.fcms.InvertibleFunction.evaluate_inverse">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">evaluate_inverse</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/fcms.html#InvertibleFunction.evaluate_inverse"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.fcms.InvertibleFunction.evaluate_inverse" title="Permalink to this definition"></a></dt>
<dd><p>Returns the outcome of applying the inverse of the function on the inputs.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="dowhy.gcm.fcms.PostNonlinearModel">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dowhy.gcm.fcms.</span></span><span class="sig-name descname"><span class="pre">PostNonlinearModel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">prediction_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#dowhy.gcm.fcms.PredictionModel" title="dowhy.gcm.fcms.PredictionModel"><span class="pre">PredictionModel</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">noise_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#dowhy.gcm.graph.StochasticModel" title="dowhy.gcm.graph.StochasticModel"><span class="pre">StochasticModel</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">invertible_function</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#dowhy.gcm.fcms.InvertibleFunction" title="dowhy.gcm.fcms.InvertibleFunction"><span class="pre">InvertibleFunction</span></a></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dowhy/gcm/fcms.html#PostNonlinearModel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.fcms.PostNonlinearModel" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#dowhy.gcm.graph.InvertibleFunctionalCausalModel" title="dowhy.gcm.graph.InvertibleFunctionalCausalModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">InvertibleFunctionalCausalModel</span></code></a></p>
<dl class="simple">
<dt>Represents an post nonlinear FCM, i.e. models of the form:</dt><dd><p>Y = g(f(X) + N),</p>
</dd>
</dl>
<p>where X are parent nodes of the target node Y, f an arbitrary prediction model expecting inputs from the
parents X, N a noise variable and g an invertible function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>prediction_model</strong> – The prediction model f.</p></li>
<li><p><strong>invertible_function</strong> – The invertible function g.</p></li>
<li><p><strong>noise_model</strong> – The StochasticModel to describe the distribution of the noise N.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="dowhy.gcm.fcms.PostNonlinearModel.clone">
<span class="sig-name descname"><span class="pre">clone</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/dowhy/gcm/fcms.html#PostNonlinearModel.clone"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.fcms.PostNonlinearModel.clone" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dowhy.gcm.fcms.PostNonlinearModel.draw_noise_samples">
<span class="sig-name descname"><span class="pre">draw_noise_samples</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_samples</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/fcms.html#PostNonlinearModel.draw_noise_samples"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.fcms.PostNonlinearModel.draw_noise_samples" title="Permalink to this definition"></a></dt>
<dd><p>Draws samples from the noise distribution N.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>num_samples</strong> – Number of noise samples.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A numpy array containing num_samples samples from the noise.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dowhy.gcm.fcms.PostNonlinearModel.estimate_noise">
<span class="sig-name descname"><span class="pre">estimate_noise</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">target_samples</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parent_samples</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/fcms.html#PostNonlinearModel.estimate_noise"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.fcms.PostNonlinearModel.estimate_noise" title="Permalink to this definition"></a></dt>
<dd><p>Reconstruct the noise given samples from (X, Y). This is done by:</p>
<blockquote>
<div><ol class="arabic simple">
<li><p>Transform Y via the inverse of g: g^-1(Y) = f(X) + N</p></li>
<li><p>Return the residual g^-1(Y) - f(X)</p></li>
</ol>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>target_samples</strong> – Samples from the input X.</p></li>
<li><p><strong>parent_samples</strong> – Samples from the target Y.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The reconstructed noise based on the given samples.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dowhy.gcm.fcms.PostNonlinearModel.evaluate">
<span class="sig-name descname"><span class="pre">evaluate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">parent_samples</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">noise_samples</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/fcms.html#PostNonlinearModel.evaluate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.fcms.PostNonlinearModel.evaluate" title="Permalink to this definition"></a></dt>
<dd><p>Evaluates the post non-linear model given samples (X, N). This is done by:</p>
<blockquote>
<div><ol class="arabic simple">
<li><p>Evaluate f(X)</p></li>
<li><p>Evaluate f(X) + N</p></li>
<li><p>Return g(f(X) + N)</p></li>
</ol>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>parent_samples</strong> – Samples from the inputs X.</p></li>
<li><p><strong>noise_samples</strong> – Samples from the noise N.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The Y values based on the given samples.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dowhy.gcm.fcms.PostNonlinearModel.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/fcms.html#PostNonlinearModel.fit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.fcms.PostNonlinearModel.fit" title="Permalink to this definition"></a></dt>
<dd><p>Fits the post non-linear model of the form Y = g(f(X) + N). Here, this consists of three steps given
samples from (X, Y):</p>
<blockquote>
<div><ol class="arabic simple">
<li><p>Transform Y via the inverse of g: g^-1(Y) = f(X) + N</p></li>
<li><p>Fit the model for f on (X, g^-1(Y))</p></li>
<li><p>Reconstruct N based on the residual N = g^-1(Y) - f(X)</p></li>
</ol>
</div></blockquote>
<p>Note that the noise here can be inferred uniquely if the model assumption holds.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> – Samples from the input X.</p></li>
<li><p><strong>Y</strong> – Samples from the target Y.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="dowhy.gcm.fcms.PostNonlinearModel.invertible_function">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">invertible_function</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#dowhy.gcm.fcms.InvertibleFunction" title="dowhy.gcm.fcms.InvertibleFunction"><span class="pre">InvertibleFunction</span></a></em><a class="headerlink" href="#dowhy.gcm.fcms.PostNonlinearModel.invertible_function" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="dowhy.gcm.fcms.PostNonlinearModel.noise_model">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">noise_model</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#dowhy.gcm.graph.StochasticModel" title="dowhy.gcm.graph.StochasticModel"><span class="pre">StochasticModel</span></a></em><a class="headerlink" href="#dowhy.gcm.fcms.PostNonlinearModel.noise_model" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="dowhy.gcm.fcms.PostNonlinearModel.prediction_model">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">prediction_model</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#dowhy.gcm.fcms.PredictionModel" title="dowhy.gcm.fcms.PredictionModel"><span class="pre">PredictionModel</span></a></em><a class="headerlink" href="#dowhy.gcm.fcms.PostNonlinearModel.prediction_model" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="dowhy.gcm.fcms.PredictionModel">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dowhy.gcm.fcms.</span></span><span class="sig-name descname"><span class="pre">PredictionModel</span></span><a class="reference internal" href="_modules/dowhy/gcm/fcms.html#PredictionModel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.fcms.PredictionModel" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Represents general prediction model implementations. Each prediction model should provide a fit and a predict
method.</p>
<dl class="py method">
<dt class="sig sig-object py" id="dowhy.gcm.fcms.PredictionModel.clone">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">clone</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/dowhy/gcm/fcms.html#PredictionModel.clone"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.fcms.PredictionModel.clone" title="Permalink to this definition"></a></dt>
<dd><p>Clones the prediction model using the same hyper parameters but not fitted.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>An unfitted clone of the prediction model.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dowhy.gcm.fcms.PredictionModel.fit">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/fcms.html#PredictionModel.fit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.fcms.PredictionModel.fit" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dowhy.gcm.fcms.PredictionModel.predict">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/fcms.html#PredictionModel.predict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.fcms.PredictionModel.predict" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="dowhy.gcm.fcms.ProbabilityEstimatorModel">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dowhy.gcm.fcms.</span></span><span class="sig-name descname"><span class="pre">ProbabilityEstimatorModel</span></span><a class="reference internal" href="_modules/dowhy/gcm/fcms.html#ProbabilityEstimatorModel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.fcms.ProbabilityEstimatorModel" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">ABC</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="dowhy.gcm.fcms.ProbabilityEstimatorModel.estimate_probabilities">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">estimate_probabilities</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">parent_samples</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/fcms.html#ProbabilityEstimatorModel.estimate_probabilities"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.fcms.ProbabilityEstimatorModel.estimate_probabilities" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="module-dowhy.gcm.fitting_sampling">
<span id="dowhy-gcm-fitting-sampling-module"></span><h2>dowhy.gcm.fitting_sampling module<a class="headerlink" href="#module-dowhy.gcm.fitting_sampling" title="Permalink to this heading"></a></h2>
<p>This module provides functionality for fitting probabilistic causal models and drawing samples from them.</p>
<p>Functions in this module should be considered experimental, meaning there might be breaking API changes in the future.</p>
<dl class="py function">
<dt class="sig sig-object py" id="dowhy.gcm.fitting_sampling.draw_samples">
<span class="sig-prename descclassname"><span class="pre">dowhy.gcm.fitting_sampling.</span></span><span class="sig-name descname"><span class="pre">draw_samples</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">causal_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#dowhy.gcm.cms.ProbabilisticCausalModel" title="dowhy.gcm.cms.ProbabilisticCausalModel"><span class="pre">ProbabilisticCausalModel</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_samples</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">DataFrame</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/fitting_sampling.html#draw_samples"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.fitting_sampling.draw_samples" title="Permalink to this definition"></a></dt>
<dd><p>Draws new joint samples from the given graphical causal model. This is done by first generating random samples
from root nodes and then propagating causal downstream effects through the graph.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>causal_model</strong> – New samples are generated based on the given causal model.</p></li>
<li><p><strong>num_samples</strong> – Number of samples to draw.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A pandas data frame where columns correspond to the nodes in the graph and rows to the drawn joint samples.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dowhy.gcm.fitting_sampling.fit">
<span class="sig-prename descclassname"><span class="pre">dowhy.gcm.fitting_sampling.</span></span><span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">causal_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#dowhy.gcm.cms.ProbabilisticCausalModel" title="dowhy.gcm.cms.ProbabilisticCausalModel"><span class="pre">ProbabilisticCausalModel</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dowhy/gcm/fitting_sampling.html#fit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.fitting_sampling.fit" title="Permalink to this definition"></a></dt>
<dd><p>Learns generative causal models of nodes in the causal graph from data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>causal_model</strong> – The causal model containing the mechanisms that will be fitted.</p></li>
<li><p><strong>data</strong> – Observations of nodes in the causal model.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dowhy.gcm.fitting_sampling.fit_causal_model_of_target">
<span class="sig-prename descclassname"><span class="pre">dowhy.gcm.fitting_sampling.</span></span><span class="sig-name descname"><span class="pre">fit_causal_model_of_target</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">causal_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#dowhy.gcm.cms.ProbabilisticCausalModel" title="dowhy.gcm.cms.ProbabilisticCausalModel"><span class="pre">ProbabilisticCausalModel</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_node</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">training_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/fitting_sampling.html#fit_causal_model_of_target"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.fitting_sampling.fit_causal_model_of_target" title="Permalink to this definition"></a></dt>
<dd><p>Fits only the causal mechanism of the given target node based on the training data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>causal_model</strong> – The causal model containing the target node.</p></li>
<li><p><strong>target_node</strong> – Target node for which the mechanism is fitted.</p></li>
<li><p><strong>training_data</strong> – Training data for fitting the causal mechanism.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-dowhy.gcm.graph">
<span id="dowhy-gcm-graph-module"></span><h2>dowhy.gcm.graph module<a class="headerlink" href="#module-dowhy.gcm.graph" title="Permalink to this heading"></a></h2>
<p>This module defines the fundamental interfaces and functions related to causal graphs in graphical causal models.</p>
<p>Classes and functions in this module should be considered experimental, meaning there might be breaking API changes in
the future.</p>
<dl class="py class">
<dt class="sig sig-object py" id="dowhy.gcm.graph.ConditionalStochasticModel">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dowhy.gcm.graph.</span></span><span class="sig-name descname"><span class="pre">ConditionalStochasticModel</span></span><a class="reference internal" href="_modules/dowhy/gcm/graph.html#ConditionalStochasticModel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.graph.ConditionalStochasticModel" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">ABC</span></code></p>
<p>A conditional stochastic model represents a model used for causal mechanisms for non-root nodes in a graphical
causal model.</p>
<dl class="py method">
<dt class="sig sig-object py" id="dowhy.gcm.graph.ConditionalStochasticModel.clone">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">clone</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/dowhy/gcm/graph.html#ConditionalStochasticModel.clone"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.graph.ConditionalStochasticModel.clone" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dowhy.gcm.graph.ConditionalStochasticModel.draw_samples">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">draw_samples</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">parent_samples</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/graph.html#ConditionalStochasticModel.draw_samples"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.graph.ConditionalStochasticModel.draw_samples" title="Permalink to this definition"></a></dt>
<dd><p>Draws samples for the fitted model.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dowhy.gcm.graph.ConditionalStochasticModel.fit">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/graph.html#ConditionalStochasticModel.fit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.graph.ConditionalStochasticModel.fit" title="Permalink to this definition"></a></dt>
<dd><p>Fits the model according to the data.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="dowhy.gcm.graph.DirectedGraph">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dowhy.gcm.graph.</span></span><span class="sig-name descname"><span class="pre">DirectedGraph</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dowhy/gcm/graph.html#DirectedGraph"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.graph.DirectedGraph" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#dowhy.gcm.graph.HasNodes" title="dowhy.gcm.graph.HasNodes"><code class="xref py py-class docutils literal notranslate"><span class="pre">HasNodes</span></code></a>, <a class="reference internal" href="#dowhy.gcm.graph.HasEdges" title="dowhy.gcm.graph.HasEdges"><code class="xref py py-class docutils literal notranslate"><span class="pre">HasEdges</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Protocol</span></code></p>
<p>A protocol representing a directed graph as needed by graphical causal models.</p>
<p>This protocol specifically defines a subset of the networkx.DiGraph class, which make that class automatically
compatible with DirectedGraph. While in most cases a networkx.DiGraph is the class of choice when constructing
a causal graph, anyone can choose to provide their own implementation of the DirectGraph interface.</p>
<dl class="py method">
<dt class="sig sig-object py" id="dowhy.gcm.graph.DirectedGraph.predecessors">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">predecessors</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">node</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dowhy/gcm/graph.html#DirectedGraph.predecessors"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.graph.DirectedGraph.predecessors" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="dowhy.gcm.graph.FunctionalCausalModel">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dowhy.gcm.graph.</span></span><span class="sig-name descname"><span class="pre">FunctionalCausalModel</span></span><a class="reference internal" href="_modules/dowhy/gcm/graph.html#FunctionalCausalModel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.graph.FunctionalCausalModel" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#dowhy.gcm.graph.ConditionalStochasticModel" title="dowhy.gcm.graph.ConditionalStochasticModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">ConditionalStochasticModel</span></code></a></p>
<p>Represents a Functional Causal Model (FCM), a specific type of conditional stochastic model, that is defined
as:</p>
<blockquote>
<div><p>Y := f(X, N), N: Noise</p>
</div></blockquote>
<dl class="py method">
<dt class="sig sig-object py" id="dowhy.gcm.graph.FunctionalCausalModel.draw_noise_samples">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">draw_noise_samples</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_samples</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/graph.html#FunctionalCausalModel.draw_noise_samples"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.graph.FunctionalCausalModel.draw_noise_samples" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dowhy.gcm.graph.FunctionalCausalModel.draw_samples">
<span class="sig-name descname"><span class="pre">draw_samples</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">parent_samples</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/graph.html#FunctionalCausalModel.draw_samples"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.graph.FunctionalCausalModel.draw_samples" title="Permalink to this definition"></a></dt>
<dd><p>Draws samples for the fitted model.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dowhy.gcm.graph.FunctionalCausalModel.evaluate">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">evaluate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">parent_samples</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">noise_samples</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/graph.html#FunctionalCausalModel.evaluate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.graph.FunctionalCausalModel.evaluate" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="dowhy.gcm.graph.HasEdges">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dowhy.gcm.graph.</span></span><span class="sig-name descname"><span class="pre">HasEdges</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dowhy/gcm/graph.html#HasEdges"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.graph.HasEdges" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Protocol</span></code></p>
<p>This protocol defines a trait for classes having edges.</p>
<dl class="py property">
<dt class="sig sig-object py" id="dowhy.gcm.graph.HasEdges.edges">
<em class="property"><span class="pre">abstract</span><span class="w"> </span><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">edges</span></span><a class="headerlink" href="#dowhy.gcm.graph.HasEdges.edges" title="Permalink to this definition"></a></dt>
<dd><p>:returns a Dict[Tuple[Any, Any], Dict[Any, Any]]</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="dowhy.gcm.graph.HasNodes">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dowhy.gcm.graph.</span></span><span class="sig-name descname"><span class="pre">HasNodes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dowhy/gcm/graph.html#HasNodes"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.graph.HasNodes" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Protocol</span></code></p>
<p>This protocol defines a trait for classes having nodes.</p>
<dl class="py property">
<dt class="sig sig-object py" id="dowhy.gcm.graph.HasNodes.nodes">
<em class="property"><span class="pre">abstract</span><span class="w"> </span><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">nodes</span></span><a class="headerlink" href="#dowhy.gcm.graph.HasNodes.nodes" title="Permalink to this definition"></a></dt>
<dd><p>:returns Dict[Any, Dict[Any, Any]]</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="dowhy.gcm.graph.InvertibleFunctionalCausalModel">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dowhy.gcm.graph.</span></span><span class="sig-name descname"><span class="pre">InvertibleFunctionalCausalModel</span></span><a class="reference internal" href="_modules/dowhy/gcm/graph.html#InvertibleFunctionalCausalModel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.graph.InvertibleFunctionalCausalModel" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#dowhy.gcm.graph.FunctionalCausalModel" title="dowhy.gcm.graph.FunctionalCausalModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">FunctionalCausalModel</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">ABC</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="dowhy.gcm.graph.InvertibleFunctionalCausalModel.estimate_noise">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">estimate_noise</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">target_samples</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parent_samples</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/graph.html#InvertibleFunctionalCausalModel.estimate_noise"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.graph.InvertibleFunctionalCausalModel.estimate_noise" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="dowhy.gcm.graph.StochasticModel">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dowhy.gcm.graph.</span></span><span class="sig-name descname"><span class="pre">StochasticModel</span></span><a class="reference internal" href="_modules/dowhy/gcm/graph.html#StochasticModel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.graph.StochasticModel" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">ABC</span></code></p>
<p>A stochastic model represents a model used for causal mechanisms for root nodes in a graphical causal model.</p>
<dl class="py method">
<dt class="sig sig-object py" id="dowhy.gcm.graph.StochasticModel.clone">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">clone</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/dowhy/gcm/graph.html#StochasticModel.clone"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.graph.StochasticModel.clone" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dowhy.gcm.graph.StochasticModel.draw_samples">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">draw_samples</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_samples</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/graph.html#StochasticModel.draw_samples"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.graph.StochasticModel.draw_samples" title="Permalink to this definition"></a></dt>
<dd><p>Draws samples for the fitted model.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dowhy.gcm.graph.StochasticModel.fit">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/graph.html#StochasticModel.fit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.graph.StochasticModel.fit" title="Permalink to this definition"></a></dt>
<dd><p>Fits the model according to the data.</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dowhy.gcm.graph.clone_causal_models">
<span class="sig-prename descclassname"><span class="pre">dowhy.gcm.graph.</span></span><span class="sig-name descname"><span class="pre">clone_causal_models</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">source</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#dowhy.gcm.graph.HasNodes" title="dowhy.gcm.graph.HasNodes"><span class="pre">HasNodes</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">destination</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#dowhy.gcm.graph.HasNodes" title="dowhy.gcm.graph.HasNodes"><span class="pre">HasNodes</span></a></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dowhy/gcm/graph.html#clone_causal_models"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.graph.clone_causal_models" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dowhy.gcm.graph.get_ordered_predecessors">
<span class="sig-prename descclassname"><span class="pre">dowhy.gcm.graph.</span></span><span class="sig-name descname"><span class="pre">get_ordered_predecessors</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">causal_graph</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#dowhy.gcm.graph.DirectedGraph" title="dowhy.gcm.graph.DirectedGraph"><span class="pre">DirectedGraph</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">node</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/dowhy/gcm/graph.html#get_ordered_predecessors"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.graph.get_ordered_predecessors" title="Permalink to this definition"></a></dt>
<dd><p>This function returns predecessors of a node in a well-defined order.</p>
<p>This is necessary, because we select subsets of columns in Dataframes by using a node’s parents, and these parents
might not be returned in a reliable order.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dowhy.gcm.graph.is_root_node">
<span class="sig-prename descclassname"><span class="pre">dowhy.gcm.graph.</span></span><span class="sig-name descname"><span class="pre">is_root_node</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">causal_graph</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#dowhy.gcm.graph.DirectedGraph" title="dowhy.gcm.graph.DirectedGraph"><span class="pre">DirectedGraph</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">node</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">bool</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/graph.html#is_root_node"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.graph.is_root_node" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dowhy.gcm.graph.node_connected_subgraph_view">
<span class="sig-prename descclassname"><span class="pre">dowhy.gcm.graph.</span></span><span class="sig-name descname"><span class="pre">node_connected_subgraph_view</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">g</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#dowhy.gcm.graph.DirectedGraph" title="dowhy.gcm.graph.DirectedGraph"><span class="pre">DirectedGraph</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">node</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Any</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/graph.html#node_connected_subgraph_view"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.graph.node_connected_subgraph_view" title="Permalink to this definition"></a></dt>
<dd><p>Returns a view of the provided graph g that contains only nodes connected to the node passed in</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dowhy.gcm.graph.validate_acyclic">
<span class="sig-prename descclassname"><span class="pre">dowhy.gcm.graph.</span></span><span class="sig-name descname"><span class="pre">validate_acyclic</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">causal_graph</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#dowhy.gcm.graph.DirectedGraph" title="dowhy.gcm.graph.DirectedGraph"><span class="pre">DirectedGraph</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/graph.html#validate_acyclic"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.graph.validate_acyclic" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dowhy.gcm.graph.validate_causal_dag">
<span class="sig-prename descclassname"><span class="pre">dowhy.gcm.graph.</span></span><span class="sig-name descname"><span class="pre">validate_causal_dag</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">causal_graph</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#dowhy.gcm.graph.DirectedGraph" title="dowhy.gcm.graph.DirectedGraph"><span class="pre">DirectedGraph</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/graph.html#validate_causal_dag"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.graph.validate_causal_dag" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dowhy.gcm.graph.validate_causal_graph">
<span class="sig-prename descclassname"><span class="pre">dowhy.gcm.graph.</span></span><span class="sig-name descname"><span class="pre">validate_causal_graph</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">causal_graph</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#dowhy.gcm.graph.DirectedGraph" title="dowhy.gcm.graph.DirectedGraph"><span class="pre">DirectedGraph</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/graph.html#validate_causal_graph"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.graph.validate_causal_graph" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dowhy.gcm.graph.validate_causal_model_assignment">
<span class="sig-prename descclassname"><span class="pre">dowhy.gcm.graph.</span></span><span class="sig-name descname"><span class="pre">validate_causal_model_assignment</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">causal_graph</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#dowhy.gcm.graph.DirectedGraph" title="dowhy.gcm.graph.DirectedGraph"><span class="pre">DirectedGraph</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_node</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/graph.html#validate_causal_model_assignment"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.graph.validate_causal_model_assignment" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dowhy.gcm.graph.validate_local_structure">
<span class="sig-prename descclassname"><span class="pre">dowhy.gcm.graph.</span></span><span class="sig-name descname"><span class="pre">validate_local_structure</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">causal_graph</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#dowhy.gcm.graph.DirectedGraph" title="dowhy.gcm.graph.DirectedGraph"><span class="pre">DirectedGraph</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">node</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/graph.html#validate_local_structure"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.graph.validate_local_structure" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dowhy.gcm.graph.validate_node">
<span class="sig-prename descclassname"><span class="pre">dowhy.gcm.graph.</span></span><span class="sig-name descname"><span class="pre">validate_node</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">causal_graph</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#dowhy.gcm.graph.DirectedGraph" title="dowhy.gcm.graph.DirectedGraph"><span class="pre">DirectedGraph</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">node</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/graph.html#validate_node"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.graph.validate_node" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dowhy.gcm.graph.validate_node_has_causal_model">
<span class="sig-prename descclassname"><span class="pre">dowhy.gcm.graph.</span></span><span class="sig-name descname"><span class="pre">validate_node_has_causal_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">causal_graph</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#dowhy.gcm.graph.HasNodes" title="dowhy.gcm.graph.HasNodes"><span class="pre">HasNodes</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">node</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/graph.html#validate_node_has_causal_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.graph.validate_node_has_causal_model" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dowhy.gcm.graph.validate_node_in_graph">
<span class="sig-prename descclassname"><span class="pre">dowhy.gcm.graph.</span></span><span class="sig-name descname"><span class="pre">validate_node_in_graph</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">causal_graph</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#dowhy.gcm.graph.HasNodes" title="dowhy.gcm.graph.HasNodes"><span class="pre">HasNodes</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">node</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/graph.html#validate_node_in_graph"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.graph.validate_node_in_graph" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</section>
<section id="module-dowhy.gcm.shapley">
<span id="dowhy-gcm-shapley-module"></span><h2>dowhy.gcm.shapley module<a class="headerlink" href="#module-dowhy.gcm.shapley" title="Permalink to this heading"></a></h2>
<p>This module provides functionality for shapley value estimation.</p>
<p>Classes and functions in this module should be considered experimental, meaning there might be breaking API changes in
the future.</p>
<dl class="py class">
<dt class="sig sig-object py" id="dowhy.gcm.shapley.ShapleyApproximationMethods">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dowhy.gcm.shapley.</span></span><span class="sig-name descname"><span class="pre">ShapleyApproximationMethods</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dowhy/gcm/shapley.html#ShapleyApproximationMethods"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.shapley.ShapleyApproximationMethods" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Enum</span></code></p>
<p>AUTO: Using EXACT when number of players is below 6 and EARLY_STOPPING otherwise.
EXACT: Generate all possible subsets and estimate Shapley values with corresponding subset weights.
EXACT_FAST: Generate all possible subsets and estimate Shapley values via weighed least squares regression. This can</p>
<blockquote>
<div><p>be faster, but, depending on the set function, numerically less stable.</p>
</div></blockquote>
<dl class="simple">
<dt>SUBSET_SAMPLING: Randomly samples subsets and estimate Shapley values via weighed least squares regression. Here,</dt><dd><p>only a certain number of randomly drawn subsets are used.</p>
</dd>
<dt>EARLY_STOPPING: Estimate Shapley values based on a few randomly generated permutations. Stop the estimation process</dt><dd><p>when the the Shapley values do not change much on average anymore between runs.</p>
</dd>
<dt>PERMUTATION: Estimates Shapley values based on a fixed number of randomly generated permutations. By fine tuning</dt><dd><p>hyperparameters, this can be potentially faster than the early stopping approach due to a better
utilization of the parallelization.</p>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="dowhy.gcm.shapley.ShapleyApproximationMethods.AUTO">
<span class="sig-name descname"><span class="pre">AUTO</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">(0,)</span></em><a class="headerlink" href="#dowhy.gcm.shapley.ShapleyApproximationMethods.AUTO" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dowhy.gcm.shapley.ShapleyApproximationMethods.EARLY_STOPPING">
<span class="sig-name descname"><span class="pre">EARLY_STOPPING</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">(3,)</span></em><a class="headerlink" href="#dowhy.gcm.shapley.ShapleyApproximationMethods.EARLY_STOPPING" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dowhy.gcm.shapley.ShapleyApproximationMethods.EXACT">
<span class="sig-name descname"><span class="pre">EXACT</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">(1,)</span></em><a class="headerlink" href="#dowhy.gcm.shapley.ShapleyApproximationMethods.EXACT" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dowhy.gcm.shapley.ShapleyApproximationMethods.EXACT_FAST">
<span class="sig-name descname"><span class="pre">EXACT_FAST</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">(2,)</span></em><a class="headerlink" href="#dowhy.gcm.shapley.ShapleyApproximationMethods.EXACT_FAST" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dowhy.gcm.shapley.ShapleyApproximationMethods.PERMUTATION">
<span class="sig-name descname"><span class="pre">PERMUTATION</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">(4,)</span></em><a class="headerlink" href="#dowhy.gcm.shapley.ShapleyApproximationMethods.PERMUTATION" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dowhy.gcm.shapley.ShapleyApproximationMethods.SUBSET_SAMPLING">
<span class="sig-name descname"><span class="pre">SUBSET_SAMPLING</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">5</span></em><a class="headerlink" href="#dowhy.gcm.shapley.ShapleyApproximationMethods.SUBSET_SAMPLING" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="dowhy.gcm.shapley.ShapleyConfig">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dowhy.gcm.shapley.</span></span><span class="sig-name descname"><span class="pre">ShapleyConfig</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">approximation_method</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#dowhy.gcm.shapley.ShapleyApproximationMethods" title="dowhy.gcm.shapley.ShapleyApproximationMethods"><span class="pre">ShapleyApproximationMethods</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">ShapleyApproximationMethods.AUTO</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_samples</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">5000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_percentage_change_threshold</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_jobs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dowhy/gcm/shapley.html#ShapleyConfig"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.shapley.ShapleyConfig" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Config for estimating Shapley values.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>approximation_method</strong> – Type of approximation methods (see <a class="reference internal" href="#dowhy.gcm.shapley.ShapleyApproximationMethods" title="dowhy.gcm.shapley.ShapleyApproximationMethods"><code class="xref py py-class docutils literal notranslate"><span class="pre">ShapleyApproximationMethods</span></code></a>).</p></li>
<li><p><strong>num_samples</strong> – Number of samples used for approximating the Shapley values. Depending on the approximation
method, this can either represent the number of drawn subsets (in SUBSET_SAMPLING) or the
number of drawn permutations (in EARLY_STOPPING and PERMUTATION). In case of EARLY_STOPPING,
this also represents a limit on the evaluation runs.</p></li>
<li><p><strong>min_percentage_change_threshold</strong> – This parameter is only relevant for EARLY_STOPPING and indicates the
minimum required change of the Shapley values between two runs
(i.e. evaluation of permutations) before the estimation stops.
For instance, if the Shapley value changes less than the given value for
a certain number of consecutive runs, the algorithm stops and returns
the current result.</p></li>
<li><p><strong>n_jobs</strong> – Number of parallel jobs.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dowhy.gcm.shapley.estimate_shapley_values">
<span class="sig-prename descclassname"><span class="pre">dowhy.gcm.shapley.</span></span><span class="sig-name descname"><span class="pre">estimate_shapley_values</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">set_func</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_players</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shapley_config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#dowhy.gcm.shapley.ShapleyConfig" title="dowhy.gcm.shapley.ShapleyConfig"><span class="pre">ShapleyConfig</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/shapley.html#estimate_shapley_values"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.shapley.estimate_shapley_values" title="Permalink to this definition"></a></dt>
<dd><p>Estimates the Shapley values based on the provided set function. A set function here is defined by taking a
(subset) of players and returning a certain utility value. This is in the context of attributing the
value of the i-th player to a subset of players S by evaluating v(S u {i}) - v(S), where v is the
set function and i is not in S. While we use the term ‘player’ here, this is often a certain feature/variable.</p>
<p>The input of the set function is a binary vector indicating which player is part of the set. For instance, given 4
players (1,2,3,4) and a subset only contains players 1,2,4, then this is indicated by the vector [1, 1, 0, 1]. The
function is expected to return a numeric value based on this input.</p>
<p>Note: The set function can be arbitrary and can resemble computationally complex operations. Keep in mind
that the estimation of Shapley values can become computationally expensive and requires a lot of memory. If the
runtime is too slow, consider changing the default config.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>set_func</strong> – A set function that expects a binary vector as input which specifies which player is part of the
subset.</p></li>
<li><p><strong>num_players</strong> – Total number of players.</p></li>
<li><p><strong>shapley_config</strong> – A config object for indicating the approximation method and other parameters. If None is
given, a default config is used. For faster runtime or more accurate results, consider
creating a custom config.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A numpy array representing the Shapley values for each player, i.e. there are as many Shapley values as
num_players. The i-th entry belongs to the i-th player. Here, the set function defines which index belongs
to which player and is responsible to keep it consistent.</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-dowhy.gcm.stats">
<span id="dowhy-gcm-stats-module"></span><h2>dowhy.gcm.stats module<a class="headerlink" href="#module-dowhy.gcm.stats" title="Permalink to this heading"></a></h2>
<p>Functions in this module should be considered experimental, meaning there might be breaking API changes in the
future.</p>
<dl class="py function">
<dt class="sig sig-object py" id="dowhy.gcm.stats.estimate_ftest_pvalue">
<span class="sig-prename descclassname"><span class="pre">dowhy.gcm.stats.</span></span><span class="sig-name descname"><span class="pre">estimate_ftest_pvalue</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X_training_a</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X_training_b</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y_training</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X_test_a</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X_test_b</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y_test</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/stats.html#estimate_ftest_pvalue"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.stats.estimate_ftest_pvalue" title="Permalink to this definition"></a></dt>
<dd><p>Estimates the p-value for the null hypothesis that the same regression error with less parameters can be
achieved. This is, a linear model trained on a data set A with d number of features has the same performance
(in terms of squared error) relative to the number of features as a model trained on a data set B with k number
features, where k &lt; d. Here, both data sets need to have the same target values. A small p-value would
indicate that the model performances are significantly different.</p>
<p>Note that all given test samples are utilized in the f-test.</p>
<p>See <a class="reference external" href="https://en.wikipedia.org/wiki/F-test#Regression_problems">https://en.wikipedia.org/wiki/F-test#Regression_problems</a> for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X_training_a</strong> – Input training samples for model A.</p></li>
<li><p><strong>X_training_b</strong> – Input training samples for model B. These samples should have less features than samples in X_training_a.</p></li>
<li><p><strong>Y_training</strong> – Target training values.</p></li>
<li><p><strong>X_test_a</strong> – Test samples for model A.</p></li>
<li><p><strong>X_test_b</strong> – Test samples for model B.</p></li>
<li><p><strong>Y_test</strong> – Test values.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A p-value on [0, 1].</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dowhy.gcm.stats.marginal_expectation">
<span class="sig-prename descclassname"><span class="pre">dowhy.gcm.stats.</span></span><span class="sig-name descname"><span class="pre">marginal_expectation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">prediction_method</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">feature_samples</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">baseline_samples</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">baseline_feature_indices</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_averaged_results</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">feature_perturbation</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'randomize_columns_jointly'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_batch_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">-</span> <span class="pre">1</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/stats.html#marginal_expectation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.stats.marginal_expectation" title="Permalink to this definition"></a></dt>
<dd><p>Estimates the marginal expectation for samples in baseline_noise_samples when randomizing features that are not
part of baseline_feature_indices. This is, this function estimates</p>
<blockquote>
<div><p>y^i = E[Y | do(x^i_s)] := int_x_s’ E[Y | x^i_s, x_s’] p(x_s’) d x_s’,</p>
</div></blockquote>
<p>where x^i_s is the i-th sample from baseline_noise_samples, s denotes the baseline_feature_indices and
x_s’ ~ X_s’ denotes the randomized features that are not in s. For an approximation of the integral, the given
prediction_method is evaluated multiple times for the same x^i_s, but different x_s’ ~ X_s’.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>prediction_method</strong> – Prediction method of interest. This should expect a numpy array as input for making</p>
</dd>
</dl>
<p>predictions.
:param feature_samples: Samples from the joint distribution. These are used for randomizing the features that are not in</p>
<blockquote>
<div><p>baseline_feature_indices.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>baseline_samples</strong> – Samples for which the marginal expectation should be estimated.</p></li>
<li><p><strong>baseline_feature_indices</strong> – Column indices of the features in s. These values for these features are remain constant
when estimating the expectation.</p></li>
<li><p><strong>return_averaged_results</strong> – If set to True, the expectation over all evaluated samples for the i-th</p></li>
</ul>
</dd>
</dl>
<p>baseline_noise_samples is returned. If set to False, all corresponding results for the i-th sample are returned.
:param feature_perturbation: Type of feature permutation:</p>
<blockquote>
<div><p>‘randomize_columns_independently’: Each feature not in s is randomly permuted separately.
‘randomize_columns_jointly’: All features not in s are jointly permuted. Note that this still represents an
interventional distribution.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>max_batch_size</strong> – Maximum batch size for a estimating the predictions. This has a significant influence on the</p>
</dd>
</dl>
<p>overall memory usage. If set to -1, all samples are used in one batch.
:return: If return_averaged_results is False, a numpy array where the i-th entry belongs to the marginal expectation
of x^i_s when randomizing the remaining features.
If return_averaged_results is True, a two dimensional numpy array where the i-th entry contains all
predictions for x^i_s when randomizing the remaining features.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dowhy.gcm.stats.permute_features">
<span class="sig-prename descclassname"><span class="pre">dowhy.gcm.stats.</span></span><span class="sig-name descname"><span class="pre">permute_features</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">feature_samples</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">features_to_permute</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">randomize_features_jointly</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/stats.html#permute_features"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.stats.permute_features" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dowhy.gcm.stats.quantile_based_fwer">
<span class="sig-prename descclassname"><span class="pre">dowhy.gcm.stats.</span></span><span class="sig-name descname"><span class="pre">quantile_based_fwer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p_values</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p_values_scaling</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quantile</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.5</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/stats.html#quantile_based_fwer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.stats.quantile_based_fwer" title="Permalink to this definition"></a></dt>
<dd><p>Applies a quantile based family wise error rate (FWER) control to the given p-values. This is based on the
approach described in:</p>
<p>Meinshausen, N., Meier, L. and Buehlmann, P. (2009).
p-values for high-dimensional regression. J. Amer. Statist. Assoc.104 1671–1681</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>p_values</strong> – A list or array of p-values.</p></li>
<li><p><strong>p_values_scaling</strong> – An optional list of scaling factors for each p-value.</p></li>
<li><p><strong>quantile</strong> – The quantile used for the p-value adjustment. By default, this is the median (0.5).</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The p-value that lies on the quantile threshold. Note that this is the quantile based on scaled values
p_values / quantile.</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-dowhy.gcm.stochastic_models">
<span id="dowhy-gcm-stochastic-models-module"></span><h2>dowhy.gcm.stochastic_models module<a class="headerlink" href="#module-dowhy.gcm.stochastic_models" title="Permalink to this heading"></a></h2>
<p>This module defines multiple implementations of the abstract class <a class="reference internal" href="#dowhy.gcm.graph.StochasticModel" title="dowhy.gcm.graph.StochasticModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">StochasticModel</span></code></a>.</p>
<p>Classes in this module should be considered experimental, meaning there might be breaking API changes in the future.</p>
<dl class="py class">
<dt class="sig sig-object py" id="dowhy.gcm.stochastic_models.BayesianGaussianMixtureDistribution">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dowhy.gcm.stochastic_models.</span></span><span class="sig-name descname"><span class="pre">BayesianGaussianMixtureDistribution</span></span><a class="reference internal" href="_modules/dowhy/gcm/stochastic_models.html#BayesianGaussianMixtureDistribution"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.stochastic_models.BayesianGaussianMixtureDistribution" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#dowhy.gcm.graph.StochasticModel" title="dowhy.gcm.graph.StochasticModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">StochasticModel</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="dowhy.gcm.stochastic_models.BayesianGaussianMixtureDistribution.clone">
<span class="sig-name descname"><span class="pre">clone</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/dowhy/gcm/stochastic_models.html#BayesianGaussianMixtureDistribution.clone"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.stochastic_models.BayesianGaussianMixtureDistribution.clone" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dowhy.gcm.stochastic_models.BayesianGaussianMixtureDistribution.draw_samples">
<span class="sig-name descname"><span class="pre">draw_samples</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_samples</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/stochastic_models.html#BayesianGaussianMixtureDistribution.draw_samples"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.stochastic_models.BayesianGaussianMixtureDistribution.draw_samples" title="Permalink to this definition"></a></dt>
<dd><p>Draws samples for the fitted model.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dowhy.gcm.stochastic_models.BayesianGaussianMixtureDistribution.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/stochastic_models.html#BayesianGaussianMixtureDistribution.fit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.stochastic_models.BayesianGaussianMixtureDistribution.fit" title="Permalink to this definition"></a></dt>
<dd><p>Fits the model according to the data.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="dowhy.gcm.stochastic_models.EmpiricalDistribution">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dowhy.gcm.stochastic_models.</span></span><span class="sig-name descname"><span class="pre">EmpiricalDistribution</span></span><a class="reference internal" href="_modules/dowhy/gcm/stochastic_models.html#EmpiricalDistribution"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.stochastic_models.EmpiricalDistribution" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#dowhy.gcm.graph.StochasticModel" title="dowhy.gcm.graph.StochasticModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">StochasticModel</span></code></a></p>
<p>An implementation of a stochastic model that uniformly samples from data samples. By randomly returning a sample
from the training data set, this model represents a parameter free representation of the marginal distribution of
the training data. However, it will not generate unseen data points. For this, consider <code class="xref py py-class docutils literal notranslate"><span class="pre">BayesianGaussianMixtureDistribution</span></code>.</p>
<dl class="py method">
<dt class="sig sig-object py" id="dowhy.gcm.stochastic_models.EmpiricalDistribution.clone">
<span class="sig-name descname"><span class="pre">clone</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/dowhy/gcm/stochastic_models.html#EmpiricalDistribution.clone"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.stochastic_models.EmpiricalDistribution.clone" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="dowhy.gcm.stochastic_models.EmpiricalDistribution.data">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">data</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ndarray</span></em><a class="headerlink" href="#dowhy.gcm.stochastic_models.EmpiricalDistribution.data" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dowhy.gcm.stochastic_models.EmpiricalDistribution.draw_samples">
<span class="sig-name descname"><span class="pre">draw_samples</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_samples</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/stochastic_models.html#EmpiricalDistribution.draw_samples"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.stochastic_models.EmpiricalDistribution.draw_samples" title="Permalink to this definition"></a></dt>
<dd><p>Draws samples for the fitted model.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dowhy.gcm.stochastic_models.EmpiricalDistribution.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/stochastic_models.html#EmpiricalDistribution.fit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.stochastic_models.EmpiricalDistribution.fit" title="Permalink to this definition"></a></dt>
<dd><p>Fits the model according to the data.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="dowhy.gcm.stochastic_models.ScipyDistribution">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dowhy.gcm.stochastic_models.</span></span><span class="sig-name descname"><span class="pre">ScipyDistribution</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">scipy_distribution</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">rv_continuous</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">rv_discrete</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">parameters</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dowhy/gcm/stochastic_models.html#ScipyDistribution"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.stochastic_models.ScipyDistribution" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#dowhy.gcm.graph.StochasticModel" title="dowhy.gcm.graph.StochasticModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">StochasticModel</span></code></a></p>
<p>Represents any parametric distribution that can be modeled by scipy.</p>
<p>Initializes a stochastic model that allows to sample from a parametric distribution implemented in Scipy.</p>
<dl class="simple">
<dt>For instance, to use a beta distribution with parameters a=2 and b=0.5:</dt><dd><p>ScipyDistribution(stats.beta, a=2, b=0.5)</p>
</dd>
<dt>Or a Gaussian distribution with mean=0 and standard deviation 2:</dt><dd><p>ScipyDistribution(stats.norm, loc=2, scale=0.5)</p>
</dd>
</dl>
<p>Note that the parameter names need to coincide with the parameter names in the corresponding Scipy
implementations. See <a class="reference external" href="https://docs.scipy.org/doc/scipy/tutorial/stats.html">https://docs.scipy.org/doc/scipy/tutorial/stats.html</a> for more information.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>scipy_distribution</strong> – A continuous or discrete distribution parametric distribution implemented in Scipy.</p></li>
<li><p><strong>parameters</strong> – Set of parameters of the parametric distribution.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="dowhy.gcm.stochastic_models.ScipyDistribution.clone">
<span class="sig-name descname"><span class="pre">clone</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/dowhy/gcm/stochastic_models.html#ScipyDistribution.clone"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.stochastic_models.ScipyDistribution.clone" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dowhy.gcm.stochastic_models.ScipyDistribution.draw_samples">
<span class="sig-name descname"><span class="pre">draw_samples</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_samples</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/stochastic_models.html#ScipyDistribution.draw_samples"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.stochastic_models.ScipyDistribution.draw_samples" title="Permalink to this definition"></a></dt>
<dd><p>Draws samples for the fitted model.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dowhy.gcm.stochastic_models.ScipyDistribution.find_suitable_continuous_distribution">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">find_suitable_continuous_distribution</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">distribution_samples</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">divergence_threshold</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.01</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">rv_continuous</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/dowhy/gcm/stochastic_models.html#ScipyDistribution.find_suitable_continuous_distribution"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.stochastic_models.ScipyDistribution.find_suitable_continuous_distribution" title="Permalink to this definition"></a></dt>
<dd><p>Tries to find the best fitting continuous parametric distribution of given samples. This is done by fitting
different parametric models and selecting the one with the smallest KL divergence between observed and generated
samples.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dowhy.gcm.stochastic_models.ScipyDistribution.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/stochastic_models.html#ScipyDistribution.fit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.stochastic_models.ScipyDistribution.fit" title="Permalink to this definition"></a></dt>
<dd><p>Fits the model according to the data.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dowhy.gcm.stochastic_models.ScipyDistribution.map_scipy_distribution_parameters_to_names">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">map_scipy_distribution_parameters_to_names</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">scipy_distribution</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">rv_continuous</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">rv_discrete</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parameters</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/dowhy/gcm/stochastic_models.html#ScipyDistribution.map_scipy_distribution_parameters_to_names"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.stochastic_models.ScipyDistribution.map_scipy_distribution_parameters_to_names" title="Permalink to this definition"></a></dt>
<dd><p>Helper function to obtain a mapping from parameter name to parameter value. Depending whether the
distribution is discrete or continuous, there are slightly different parameter names. The given parameters are
assumed to follow the order as provided by the scipy fit function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>scipy_distribution</strong> – The scipy distribution.</p></li>
<li><p><strong>parameters</strong> – The values of the corresponding parameters of the distribution. Here, it is expected to
follow the same order as defined by the scipy fit function.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A dictionary that maps a parameter name to its value.</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="dowhy.gcm.stochastic_models.ScipyDistribution.parameters">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">parameters</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#dowhy.gcm.stochastic_models.ScipyDistribution.parameters" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="dowhy.gcm.stochastic_models.ScipyDistribution.scipy_distribution">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">scipy_distribution</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">rv_continuous</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">rv_discrete</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#dowhy.gcm.stochastic_models.ScipyDistribution.scipy_distribution" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="module-dowhy.gcm.whatif">
<span id="dowhy-gcm-whatif-module"></span><h2>dowhy.gcm.whatif module<a class="headerlink" href="#module-dowhy.gcm.whatif" title="Permalink to this heading"></a></h2>
<p>This module provides functionality to answer what-if questions.</p>
<p>Functions in this module should be considered experimental, meaning there might be breaking API changes in the future.</p>
<dl class="py function">
<dt class="sig sig-object py" id="dowhy.gcm.whatif.counterfactual_samples">
<span class="sig-prename descclassname"><span class="pre">dowhy.gcm.whatif.</span></span><span class="sig-name descname"><span class="pre">counterfactual_samples</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">causal_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#dowhy.gcm.cms.StructuralCausalModel" title="dowhy.gcm.cms.StructuralCausalModel"><span class="pre">StructuralCausalModel</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#dowhy.gcm.cms.InvertibleStructuralCausalModel" title="dowhy.gcm.cms.InvertibleStructuralCausalModel"><span class="pre">InvertibleStructuralCausalModel</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interventions</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">observed_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">DataFrame</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">noise_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">DataFrame</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">DataFrame</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/whatif.html#counterfactual_samples"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.whatif.counterfactual_samples" title="Permalink to this definition"></a></dt>
<dd><p>Estimates counterfactual data for observed data if we were to perform specified interventions. This function
implements the 3-step process for computing counterfactuals by Pearl (see <a class="reference external" href="https://ftp.cs.ucla.edu/pub/stat_ser/r485.pdf">https://ftp.cs.ucla.edu/pub/stat_ser/r485.pdf</a>).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>causal_model</strong> – The (invertible) structural causal model we perform this intervention on. If noise_data is
None and observed_data is provided, this must be an invertible structural model, otherwise,
this can be either a structural causal model or an invertible one.</p></li>
<li><p><strong>interventions</strong> – Dictionary containing the interventions we want to perform keyed by node name. An
intervention is a function that takes a value as input and returns another value.
For example, <cite>{‘X’: lambda x: 2}</cite> mimics the atomic intervention <em>do(X:=2)</em>.</p></li>
<li><p><strong>observed_data</strong> – Factual data that we observe for the nodes in the causal graph.</p></li>
<li><p><strong>noise_data</strong> – Data of noise terms corresponding to nodes in the causal graph. If not provided,
these have to be estimated from observed data. Then we require causal models of nodes to be
invertible.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Estimated counterfactual data.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dowhy.gcm.whatif.interventional_samples">
<span class="sig-prename descclassname"><span class="pre">dowhy.gcm.whatif.</span></span><span class="sig-name descname"><span class="pre">interventional_samples</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">causal_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#dowhy.gcm.cms.ProbabilisticCausalModel" title="dowhy.gcm.cms.ProbabilisticCausalModel"><span class="pre">ProbabilisticCausalModel</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">interventions</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">observed_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">DataFrame</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_samples_to_draw</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">DataFrame</span></span></span><a class="reference internal" href="_modules/dowhy/gcm/whatif.html#interventional_samples"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dowhy.gcm.whatif.interventional_samples" title="Permalink to this definition"></a></dt>
<dd><p>Performs intervention on nodes in the causal graph.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>causal_model</strong> – The probabilistic causal model we perform this intervention on .</p></li>
<li><p><strong>interventions</strong> – Dictionary containing the interventions we want to perform, keyed by node name. An
intervention is a function that takes a value as input and returns another value.
For example, <cite>{‘X’: lambda x: 2}</cite> mimics the atomic intervention <em>do(X:=2)</em>.
A soft intervention can be formulated as <cite>{‘X’: lambda x: 0.2 * x}</cite>.</p></li>
<li><p><strong>observed_data</strong> – Optionally, data on which to perform interventions. If None are given, data is generated based
on the generative models.</p></li>
<li><p><strong>num_samples_to_draw</strong> – Sample size to draw from the interventional distribution.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Samples from the interventional distribution.</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-dowhy.gcm">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-dowhy.gcm" title="Permalink to this heading"></a></h2>
<p>The gcm sub-package provides features built on top of graphical causal model (GCM) based inference. The status of
this addition and its API is considered experimental, meaning there might be breaking changes to its API in the
future.</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="dowhy.do_samplers.html" class="btn btn-neutral float-left" title="dowhy.do_samplers package" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="dowhy.gcm.independence_test.html" class="btn btn-neutral float-right" title="dowhy.gcm.independence_test package" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, PyWhy contributors.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  
<div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    <span class="fa fa-book"> Other Versions</span>
    v: master-branch
    <span class="fa fa-caret-down"></span>
  </span>
    <div class="rst-other-versions">
        <dl>
            <dt>Releases</dt>
            <dd><a href="../v0.7.1/index.html">v0.7.1</a></dd>
        </dl>
        <dl>
            <dt>Branches</dt>
            <dd><a href="dowhy.gcm.html">master</a></dd>
        </dl>
    </div>
</div><script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>