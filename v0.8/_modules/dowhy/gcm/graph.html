<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-B139P18WHM"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-B139P18WHM');
</script>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>dowhy.gcm.graph &mdash; DoWhy  documentation</title>
      <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/copybutton.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
        <script src="../../../_static/jquery.js"></script>
        <script src="../../../_static/underscore.js"></script>
        <script src="../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../../../_static/doctools.js"></script>
        <script src="../../../_static/clipboard.min.js"></script>
        <script src="../../../_static/copybutton.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../../../index.html" class="icon icon-home"> DoWhy
          </a>
              <div class="version">
                v0.8
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../getting_started/intro.html">Introduction to DoWhy</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../getting_started/install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../example_notebooks/dowhy_simple_example.html">Quick-start notebook</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../getting_started/comparison.html">Comparison to other packages</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../getting_started/cite.html">Citing this package</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">User Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../user_guide/causality_intro.html">Introduction to causality</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../user_guide/effect_inference/index.html">Effect inference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../user_guide/gcm_based_inference/index.html">GCM-based inference (Experimental)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../example_notebooks/nb_index.html">Example notebooks</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Tutorials/Case studies</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../example_notebooks/tutorial-causalinference-machinelearning-using-dowhy-econml.html">CATE estimation with DoWhy+EconML</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../example_notebooks/dowhy_example_effect_of_memberrewards_program.html">Effect of membership rewards program</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../example_notebooks/DoWhy-The%20Causal%20Story%20Behind%20Hotel%20Booking%20Cancellations.html">Understanding hotel booking cancellations</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Contributing</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../contributing/index.html">Contributing to DoWhy</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Package</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../code_repo.html">Code repository &amp; Versions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../dowhy.html">dowhy package</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">DoWhy</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="../../index.html">Module code</a> &raquo;</li>
      <li>dowhy.gcm.graph</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for dowhy.gcm.graph</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot;This module defines the fundamental interfaces and functions related to causal graphs in graphical causal models.</span>

<span class="sd">Classes and functions in this module should be considered experimental, meaning there might be breaking API changes in</span>
<span class="sd">the future.</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">from</span> <span class="nn">abc</span> <span class="kn">import</span> <span class="n">abstractmethod</span><span class="p">,</span> <span class="n">ABC</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Any</span><span class="p">,</span> <span class="n">List</span>

<span class="kn">import</span> <span class="nn">networkx</span> <span class="k">as</span> <span class="nn">nx</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">networkx.algorithms.dag</span> <span class="kn">import</span> <span class="n">has_cycle</span>
<span class="kn">from</span> <span class="nn">typing_extensions</span> <span class="kn">import</span> <span class="n">Protocol</span>

<span class="c1"># This constant is used as key when storing/accessing models as causal mechanisms in graph node attributes</span>
<span class="n">CAUSAL_MECHANISM</span> <span class="o">=</span> <span class="s1">&#39;causal_mechanism&#39;</span>

<span class="c1"># This constant is used as key when storing the parents of a node during fitting. It&#39;s used for validation purposes</span>
<span class="c1"># afterwards.</span>
<span class="n">PARENTS_DURING_FIT</span> <span class="o">=</span> <span class="s1">&#39;parents_during_fit&#39;</span>


<div class="viewcode-block" id="HasNodes"><a class="viewcode-back" href="../../../dowhy.gcm.html#dowhy.gcm.graph.HasNodes">[docs]</a><span class="k">class</span> <span class="nc">HasNodes</span><span class="p">(</span><span class="n">Protocol</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;This protocol defines a trait for classes having nodes.&quot;&quot;&quot;</span>

    <span class="nd">@property</span>
    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">nodes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;:returns Dict[Any, Dict[Any, Any]]&quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span></div>


<div class="viewcode-block" id="HasEdges"><a class="viewcode-back" href="../../../dowhy.gcm.html#dowhy.gcm.graph.HasEdges">[docs]</a><span class="k">class</span> <span class="nc">HasEdges</span><span class="p">(</span><span class="n">Protocol</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;This protocol defines a trait for classes having edges.&quot;&quot;&quot;</span>

    <span class="nd">@property</span>
    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">edges</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;:returns a Dict[Tuple[Any, Any], Dict[Any, Any]]&quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span></div>


<div class="viewcode-block" id="DirectedGraph"><a class="viewcode-back" href="../../../dowhy.gcm.html#dowhy.gcm.graph.DirectedGraph">[docs]</a><span class="k">class</span> <span class="nc">DirectedGraph</span><span class="p">(</span><span class="n">HasNodes</span><span class="p">,</span> <span class="n">HasEdges</span><span class="p">,</span> <span class="n">Protocol</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;A protocol representing a directed graph as needed by graphical causal models.</span>

<span class="sd">    This protocol specifically defines a subset of the networkx.DiGraph class, which make that class automatically</span>
<span class="sd">    compatible with DirectedGraph. While in most cases a networkx.DiGraph is the class of choice when constructing</span>
<span class="sd">    a causal graph, anyone can choose to provide their own implementation of the DirectGraph interface.</span>
<span class="sd">    &quot;&quot;&quot;</span>

<div class="viewcode-block" id="DirectedGraph.predecessors"><a class="viewcode-back" href="../../../dowhy.gcm.html#dowhy.gcm.graph.DirectedGraph.predecessors">[docs]</a>    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">predecessors</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span></div></div>


<div class="viewcode-block" id="StochasticModel"><a class="viewcode-back" href="../../../dowhy.gcm.html#dowhy.gcm.graph.StochasticModel">[docs]</a><span class="k">class</span> <span class="nc">StochasticModel</span><span class="p">(</span><span class="n">ABC</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;A stochastic model represents a model used for causal mechanisms for root nodes in a graphical causal model.&quot;&quot;&quot;</span>

<div class="viewcode-block" id="StochasticModel.fit"><a class="viewcode-back" href="../../../dowhy.gcm.html#dowhy.gcm.graph.StochasticModel.fit">[docs]</a>    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Fits the model according to the data.&quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span></div>

<div class="viewcode-block" id="StochasticModel.draw_samples"><a class="viewcode-back" href="../../../dowhy.gcm.html#dowhy.gcm.graph.StochasticModel.draw_samples">[docs]</a>    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">draw_samples</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">num_samples</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Draws samples for the fitted model.&quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span></div>

<div class="viewcode-block" id="StochasticModel.clone"><a class="viewcode-back" href="../../../dowhy.gcm.html#dowhy.gcm.graph.StochasticModel.clone">[docs]</a>    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">clone</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span></div></div>


<div class="viewcode-block" id="ConditionalStochasticModel"><a class="viewcode-back" href="../../../dowhy.gcm.html#dowhy.gcm.graph.ConditionalStochasticModel">[docs]</a><span class="k">class</span> <span class="nc">ConditionalStochasticModel</span><span class="p">(</span><span class="n">ABC</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;A conditional stochastic model represents a model used for causal mechanisms for non-root nodes in a graphical</span>
<span class="sd">    causal model.&quot;&quot;&quot;</span>

<div class="viewcode-block" id="ConditionalStochasticModel.fit"><a class="viewcode-back" href="../../../dowhy.gcm.html#dowhy.gcm.graph.ConditionalStochasticModel.fit">[docs]</a>    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">Y</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Fits the model according to the data.&quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span></div>

<div class="viewcode-block" id="ConditionalStochasticModel.draw_samples"><a class="viewcode-back" href="../../../dowhy.gcm.html#dowhy.gcm.graph.ConditionalStochasticModel.draw_samples">[docs]</a>    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">draw_samples</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent_samples</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Draws samples for the fitted model.&quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span></div>

<div class="viewcode-block" id="ConditionalStochasticModel.clone"><a class="viewcode-back" href="../../../dowhy.gcm.html#dowhy.gcm.graph.ConditionalStochasticModel.clone">[docs]</a>    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">clone</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span></div></div>


<div class="viewcode-block" id="FunctionalCausalModel"><a class="viewcode-back" href="../../../dowhy.gcm.html#dowhy.gcm.graph.FunctionalCausalModel">[docs]</a><span class="k">class</span> <span class="nc">FunctionalCausalModel</span><span class="p">(</span><span class="n">ConditionalStochasticModel</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Represents a Functional Causal Model (FCM), a specific type of conditional stochastic model, that is defined</span>
<span class="sd">    as:</span>
<span class="sd">        Y := f(X, N), N: Noise</span>
<span class="sd">    &quot;&quot;&quot;</span>

<div class="viewcode-block" id="FunctionalCausalModel.draw_samples"><a class="viewcode-back" href="../../../dowhy.gcm.html#dowhy.gcm.graph.FunctionalCausalModel.draw_samples">[docs]</a>    <span class="k">def</span> <span class="nf">draw_samples</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent_samples</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">parent_samples</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">draw_noise_samples</span><span class="p">(</span><span class="n">parent_samples</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span></div>

<div class="viewcode-block" id="FunctionalCausalModel.draw_noise_samples"><a class="viewcode-back" href="../../../dowhy.gcm.html#dowhy.gcm.graph.FunctionalCausalModel.draw_noise_samples">[docs]</a>    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">draw_noise_samples</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">num_samples</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span></div>

<div class="viewcode-block" id="FunctionalCausalModel.evaluate"><a class="viewcode-back" href="../../../dowhy.gcm.html#dowhy.gcm.graph.FunctionalCausalModel.evaluate">[docs]</a>    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">evaluate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent_samples</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">noise_samples</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span></div></div>


<div class="viewcode-block" id="InvertibleFunctionalCausalModel"><a class="viewcode-back" href="../../../dowhy.gcm.html#dowhy.gcm.graph.InvertibleFunctionalCausalModel">[docs]</a><span class="k">class</span> <span class="nc">InvertibleFunctionalCausalModel</span><span class="p">(</span><span class="n">FunctionalCausalModel</span><span class="p">,</span> <span class="n">ABC</span><span class="p">):</span>
<div class="viewcode-block" id="InvertibleFunctionalCausalModel.estimate_noise"><a class="viewcode-back" href="../../../dowhy.gcm.html#dowhy.gcm.graph.InvertibleFunctionalCausalModel.estimate_noise">[docs]</a>    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">estimate_noise</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target_samples</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">parent_samples</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span></div></div>


<div class="viewcode-block" id="is_root_node"><a class="viewcode-back" href="../../../dowhy.gcm.html#dowhy.gcm.graph.is_root_node">[docs]</a><span class="k">def</span> <span class="nf">is_root_node</span><span class="p">(</span><span class="n">causal_graph</span><span class="p">:</span> <span class="n">DirectedGraph</span><span class="p">,</span> <span class="n">node</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
    <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="n">causal_graph</span><span class="o">.</span><span class="n">predecessors</span><span class="p">(</span><span class="n">node</span><span class="p">))</span> <span class="o">==</span> <span class="p">[]</span></div>


<div class="viewcode-block" id="get_ordered_predecessors"><a class="viewcode-back" href="../../../dowhy.gcm.html#dowhy.gcm.graph.get_ordered_predecessors">[docs]</a><span class="k">def</span> <span class="nf">get_ordered_predecessors</span><span class="p">(</span><span class="n">causal_graph</span><span class="p">:</span> <span class="n">DirectedGraph</span><span class="p">,</span> <span class="n">node</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Any</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;This function returns predecessors of a node in a well-defined order.</span>

<span class="sd">    This is necessary, because we select subsets of columns in Dataframes by using a node&#39;s parents, and these parents</span>
<span class="sd">    might not be returned in a reliable order.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">causal_graph</span><span class="o">.</span><span class="n">predecessors</span><span class="p">(</span><span class="n">node</span><span class="p">))</span></div>


<div class="viewcode-block" id="node_connected_subgraph_view"><a class="viewcode-back" href="../../../dowhy.gcm.html#dowhy.gcm.graph.node_connected_subgraph_view">[docs]</a><span class="k">def</span> <span class="nf">node_connected_subgraph_view</span><span class="p">(</span><span class="n">g</span><span class="p">:</span> <span class="n">DirectedGraph</span><span class="p">,</span> <span class="n">node</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Returns a view of the provided graph g that contains only nodes connected to the node passed in&quot;&quot;&quot;</span>
    <span class="c1"># can&#39;t use nx.node_connected_component, because it doesn&#39;t work with DiGraphs.</span>
    <span class="c1"># Hence a manual loop:</span>
    <span class="k">return</span> <span class="n">nx</span><span class="o">.</span><span class="n">induced_subgraph</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="p">[</span><span class="n">n</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">g</span><span class="o">.</span><span class="n">nodes</span> <span class="k">if</span> <span class="n">nx</span><span class="o">.</span><span class="n">has_path</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">node</span><span class="p">)])</span></div>


<div class="viewcode-block" id="clone_causal_models"><a class="viewcode-back" href="../../../dowhy.gcm.html#dowhy.gcm.graph.clone_causal_models">[docs]</a><span class="k">def</span> <span class="nf">clone_causal_models</span><span class="p">(</span><span class="n">source</span><span class="p">:</span> <span class="n">HasNodes</span><span class="p">,</span> <span class="n">destination</span><span class="p">:</span> <span class="n">HasNodes</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">destination</span><span class="o">.</span><span class="n">nodes</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">CAUSAL_MECHANISM</span> <span class="ow">in</span> <span class="n">source</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="n">node</span><span class="p">]:</span>
            <span class="n">destination</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="n">node</span><span class="p">][</span><span class="n">CAUSAL_MECHANISM</span><span class="p">]</span> <span class="o">=</span> <span class="n">source</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="n">node</span><span class="p">][</span><span class="n">CAUSAL_MECHANISM</span><span class="p">]</span><span class="o">.</span><span class="n">clone</span><span class="p">()</span></div>


<div class="viewcode-block" id="validate_acyclic"><a class="viewcode-back" href="../../../dowhy.gcm.html#dowhy.gcm.graph.validate_acyclic">[docs]</a><span class="k">def</span> <span class="nf">validate_acyclic</span><span class="p">(</span><span class="n">causal_graph</span><span class="p">:</span> <span class="n">DirectedGraph</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">has_cycle</span><span class="p">(</span><span class="n">causal_graph</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s1">&#39;The graph contains a cycle, but an acyclic graph is expected!&#39;</span><span class="p">)</span></div>


<div class="viewcode-block" id="validate_causal_dag"><a class="viewcode-back" href="../../../dowhy.gcm.html#dowhy.gcm.graph.validate_causal_dag">[docs]</a><span class="k">def</span> <span class="nf">validate_causal_dag</span><span class="p">(</span><span class="n">causal_graph</span><span class="p">:</span> <span class="n">DirectedGraph</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">validate_acyclic</span><span class="p">(</span><span class="n">causal_graph</span><span class="p">)</span>
    <span class="n">validate_causal_graph</span><span class="p">(</span><span class="n">causal_graph</span><span class="p">)</span></div>


<div class="viewcode-block" id="validate_causal_graph"><a class="viewcode-back" href="../../../dowhy.gcm.html#dowhy.gcm.graph.validate_causal_graph">[docs]</a><span class="k">def</span> <span class="nf">validate_causal_graph</span><span class="p">(</span><span class="n">causal_graph</span><span class="p">:</span> <span class="n">DirectedGraph</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">causal_graph</span><span class="o">.</span><span class="n">nodes</span><span class="p">:</span>
        <span class="n">validate_node</span><span class="p">(</span><span class="n">causal_graph</span><span class="p">,</span> <span class="n">node</span><span class="p">)</span></div>


<div class="viewcode-block" id="validate_node"><a class="viewcode-back" href="../../../dowhy.gcm.html#dowhy.gcm.graph.validate_node">[docs]</a><span class="k">def</span> <span class="nf">validate_node</span><span class="p">(</span><span class="n">causal_graph</span><span class="p">:</span> <span class="n">DirectedGraph</span><span class="p">,</span> <span class="n">node</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">validate_causal_model_assignment</span><span class="p">(</span><span class="n">causal_graph</span><span class="p">,</span> <span class="n">node</span><span class="p">)</span>
    <span class="n">validate_local_structure</span><span class="p">(</span><span class="n">causal_graph</span><span class="p">,</span> <span class="n">node</span><span class="p">)</span></div>


<div class="viewcode-block" id="validate_causal_model_assignment"><a class="viewcode-back" href="../../../dowhy.gcm.html#dowhy.gcm.graph.validate_causal_model_assignment">[docs]</a><span class="k">def</span> <span class="nf">validate_causal_model_assignment</span><span class="p">(</span><span class="n">causal_graph</span><span class="p">:</span> <span class="n">DirectedGraph</span><span class="p">,</span> <span class="n">target_node</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">validate_node_has_causal_model</span><span class="p">(</span><span class="n">causal_graph</span><span class="p">,</span> <span class="n">target_node</span><span class="p">)</span>

    <span class="n">causal_model</span> <span class="o">=</span> <span class="n">causal_graph</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="n">target_node</span><span class="p">][</span><span class="n">CAUSAL_MECHANISM</span><span class="p">]</span>

    <span class="k">if</span> <span class="n">is_root_node</span><span class="p">(</span><span class="n">causal_graph</span><span class="p">,</span> <span class="n">target_node</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">causal_model</span><span class="p">,</span> <span class="n">StochasticModel</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s1">&#39;Node </span><span class="si">%s</span><span class="s1"> is a root node and, thus, requires a StochasticModel, &#39;</span>
                               <span class="s1">&#39;but a </span><span class="si">%s</span><span class="s1"> was found!&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">target_node</span><span class="p">,</span> <span class="n">causal_model</span><span class="p">))</span>
    <span class="k">elif</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">causal_model</span><span class="p">,</span> <span class="n">ConditionalStochasticModel</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s1">&#39;Node </span><span class="si">%s</span><span class="s1"> has parents and, thus, requires a ConditionalStochasticModel, &#39;</span>
                           <span class="s1">&#39;but a </span><span class="si">%s</span><span class="s1"> was found!&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">target_node</span><span class="p">,</span> <span class="n">causal_model</span><span class="p">))</span></div>


<div class="viewcode-block" id="validate_local_structure"><a class="viewcode-back" href="../../../dowhy.gcm.html#dowhy.gcm.graph.validate_local_structure">[docs]</a><span class="k">def</span> <span class="nf">validate_local_structure</span><span class="p">(</span><span class="n">causal_graph</span><span class="p">:</span> <span class="n">DirectedGraph</span><span class="p">,</span> <span class="n">node</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">PARENTS_DURING_FIT</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">causal_graph</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="n">node</span><span class="p">]</span> \
            <span class="ow">or</span> <span class="n">causal_graph</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="n">node</span><span class="p">][</span><span class="n">PARENTS_DURING_FIT</span><span class="p">]</span> \
            <span class="o">!=</span> <span class="n">get_ordered_predecessors</span><span class="p">(</span><span class="n">causal_graph</span><span class="p">,</span> <span class="n">node</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s1">&#39;The causal mechanism of node </span><span class="si">%s</span><span class="s1"> is not fitted to the graphical structure! Fit all&#39;</span>
                           <span class="s1">&#39;causal models in the graph first. If the mechanism is already fitted based on the causal&#39;</span>
                           <span class="s1">&#39;parents, consider to update the persisted parents for that node manually.&#39;</span> <span class="o">%</span> <span class="n">node</span><span class="p">)</span></div>


<div class="viewcode-block" id="validate_node_has_causal_model"><a class="viewcode-back" href="../../../dowhy.gcm.html#dowhy.gcm.graph.validate_node_has_causal_model">[docs]</a><span class="k">def</span> <span class="nf">validate_node_has_causal_model</span><span class="p">(</span><span class="n">causal_graph</span><span class="p">:</span> <span class="n">HasNodes</span><span class="p">,</span> <span class="n">node</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">validate_node_in_graph</span><span class="p">(</span><span class="n">causal_graph</span><span class="p">,</span> <span class="n">node</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">CAUSAL_MECHANISM</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">causal_graph</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="n">node</span><span class="p">]:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Node </span><span class="si">%s</span><span class="s2"> has no assigned causal mechanism!&quot;</span> <span class="o">%</span> <span class="n">node</span><span class="p">)</span></div>


<div class="viewcode-block" id="validate_node_in_graph"><a class="viewcode-back" href="../../../dowhy.gcm.html#dowhy.gcm.graph.validate_node_in_graph">[docs]</a><span class="k">def</span> <span class="nf">validate_node_in_graph</span><span class="p">(</span><span class="n">causal_graph</span><span class="p">:</span> <span class="n">HasNodes</span><span class="p">,</span> <span class="n">node</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">node</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">causal_graph</span><span class="o">.</span><span class="n">nodes</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Node </span><span class="si">%s</span><span class="s2"> can not be found in the given graph!&quot;</span> <span class="o">%</span> <span class="n">node</span><span class="p">)</span></div>
</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, PyWhy contributors.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  
<div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    <span class="fa fa-book"> Other Versions</span>
    v: v0.8
    <span class="fa fa-caret-down"></span>
  </span>
    <div class="rst-other-versions">
        <dl>
            <dt>Releases</dt>
            <dd><a href="../../../../v0.1.1-alpha/index.html">v0.1.1-alpha</a></dd>
            <dd><a href="../../../../v0.2/index.html">v0.2</a></dd>
            <dd><a href="../../../../v0.4/index.html">v0.4</a></dd>
            <dd><a href="../../../../v0.5/index.html">v0.5</a></dd>
            <dd><a href="../../../../v0.5.1/index.html">v0.5.1</a></dd>
            <dd><a href="../../../../v0.6/index.html">v0.6</a></dd>
            <dd><a href="../../../../v0.7/index.html">v0.7</a></dd>
            <dd><a href="../../../../v0.7.1/index.html">v0.7.1</a></dd>
            <dd><a href="graph.html">v0.8</a></dd>
            <!-- TODO: add mechanism to add new version here. Probably just render them in from generate_docs.sh. -->
        </dl>
        <dl>
            <dt>Branches</dt>
            <!-- hard-coding the link to main -->
            <!-- It would be nice if this opened the same page on main branch, but that seems to be overkill
                 right now. Therefore defaulting to the starting page (index). -->
            <dd><a href="/dowhy/main/index.html">main</a></dd>
        </dl>
    </div>
</div><script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>