
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-B139P18WHM"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-B139P18WHM');
    </script>
    
    <title>Types of graphical causal models &#8212; DoWhy  documentation</title>
<script>
  document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
  document.documentElement.dataset.theme = localStorage.getItem("theme") || "light"
</script>

  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=92025949c220c2e29695" rel="stylesheet">
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=92025949c220c2e29695" rel="stylesheet">


  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />

  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=92025949c220c2e29695">

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/sphinx_highlight.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script src="../../_static/design-tabs.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@jupyter-widgets/html-manager@^1.0.1/dist/embed-amd.js"></script>
    <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta name="docsearch:language" content="en">
  </head>
  
  
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="180" data-default-mode="">
    <div class="bd-header-announcement container-fluid" id="banner">
      

    </div>

    
    <nav class="bd-header navbar navbar-light navbar-expand-lg bg-light fixed-top bd-navbar" id="navbar-main"><div class="bd-header__inner container-xl">

  <div id="navbar-start">
    
    
  


<a class="navbar-brand logo" href="../../index.html">
  
  
  
  
    <img src="../../_static/dowhy-logo-small.png" class="logo__image only-light" alt="Logo image">
    <img src="../../_static/dowhy-logo-small.png" class="logo__image only-dark" alt="Logo image">
  
  
</a>
    
  </div>

  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-collapsible" aria-controls="navbar-collapsible" aria-expanded="false" aria-label="Toggle navigation">
    <span class="fas fa-bars"></span>
  </button>

  
  <div id="navbar-collapsible" class="col-lg-9 collapse navbar-collapse">
    <div id="navbar-center" class="mr-auto">
      
      <div class="navbar-center-item">
        <ul id="navbar-main-elements" class="navbar-nav">
    <li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../../getting_started/index.html">
  Getting Started
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../index.html">
  User Guide
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../../example_notebooks/nb_index.html">
  Examples
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../../dowhy.html">
  API reference
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../../contributing.html">
  Contributing
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../../code_repo.html">
  Release notes
 </a>
</li>

    
</ul>
      </div>
      
    </div>

    <div id="navbar-end">
      
      <div class="navbar-end-item">
        <ul id="navbar-icon-links" class="navbar-nav" aria-label="Icon Links">
      </ul>
      </div>
      
      <div class="navbar-end-item">
        <div class="dropdown" id="version_switcher">
    <button type="button" class="btn btn-sm navbar-btn dropdown-toggle" id="version_switcher_button" data-toggle="dropdown">
        main
        <span class="caret"></span>
    </button>
    <div id="version_switcher_menu" class="dropdown-menu list-group-flush py-0" aria-labelledby="version_switcher_button">
        <dl>
            <dt>Releases</dt>
            <dd><a href="/dowhy/v0.7.1/index.html">v0.7.1</a></dd>
            <dd><a href="/dowhy/v0.7/index.html">v0.7</a></dd>
            <dd><a href="/dowhy/v0.6/index.html">v0.6</a></dd>
            <dd><a href="/dowhy/v0.5.1/index.html">v0.5.1</a></dd>
            <dd><a href="/dowhy/v0.5/index.html">v0.5</a></dd>
            <dd><a href="/dowhy/v0.4/index.html">v0.4</a></dd>
            <dd><a href="/dowhy/v0.2/index.html">v0.2</a></dd>
            <dd><a href="/dowhy/v0.1.1-alpha/index.html">v0.1.1-alpha</a></dd>
        </dl>        
        <dl>
            <dt>Branches</dt>
            <dd><a href="">main</a></dd>
        </dl>        
    </div>
</div>
      </div>
      
    </div>
  </div>
</div>
    </nav>
    

    <div class="bd-container container-xl">
      <div class="bd-container__inner row">
          

<!-- Only show if we have sidebars configured, else just a small margin  -->
<div class="bd-sidebar-primary col-12 col-md-3 bd-sidebar">
  <div class="sidebar-start-items"><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <div class="bd-toc-item active">
    
  </div>
</nav>
  </div>
  <div class="sidebar-end-items">
  </div>
</div>


          


<div class="bd-sidebar-secondary d-none d-xl-block col-xl-2 bd-toc">
  
    
    <div class="toc-item">
      

<nav id="bd-toc-nav">
    
</nav>
    </div>
    
    <div class="toc-item">
      
    </div>
    
  
</div>


          
          
          <div class="bd-content col-12 col-md-9 col-xl-7">
              
              <article class="bd-article" role="main">
                
  <section id="types-of-graphical-causal-models">
<h1>Types of graphical causal models<a class="headerlink" href="#types-of-graphical-causal-models" title="Permalink to this heading"></a></h1>
<p>A graphical causal model (GCM) comprises a graphical structure of causal relationships (e.g., X→Y) and causal mechanisms (i.e., <span class="math notranslate nohighlight">\(P(Y|X)\)</span>)
that describe the (conditional) distribution of each node. In other words, a GCM aims at representing the true data generation process.
For a given set of variables <span class="math notranslate nohighlight">\(X_0, ..., X_n\)</span>, a GCM models the joint distribution that can be factorized as <span class="math notranslate nohighlight">\(P(X_0, ..., X_n) = \prod_i P(X_i|PA_i)\)</span>
where <span class="math notranslate nohighlight">\(PA_i\)</span> are the parents of <span class="math notranslate nohighlight">\(X_i\)</span>, which could be an empty set in the case of root nodes. The causal
mechanism <span class="math notranslate nohighlight">\(P(X_i|PA_i)\)</span> may require additional constraints depending on the type of causal questions.</p>
<p>Pearl identifies three levels on the ladder of causality:</p>
<p>1. Association: Evaluate and reason using observational data <span class="math notranslate nohighlight">\(P(X_0, ..., X_n)\)</span>. This level is common for machine
learning prediction problems.
2. Intervention: Execute interventions and estimate causal effects. This level is most relevant for causal effect
estimation questions, where we obtain interventional distributions in the form <span class="math notranslate nohighlight">\(P(Y|do(X=...))\)</span>.
3. Counterfactuals: Estimate counterfactual outcomes of observed events. The main difference between interventions and
counterfactuals is that interventions focus on “forward-looking” questions like “What will happen if we change X?”,
while counterfactuals examine hypothetical scenarios that deviate from the actual observed event, such as
“What if X had taken a different value, how would our observation have been?”.</p>
<p>Estimating counterfactuals in Pearl’s framework demands stronger assumptions on causal mechanisms compared to those
needed for estimating interventions. DoWhy offers three different classes with varying degrees of causal mechanism flexibility:</p>
<ul class="simple">
<li><p>ProbabilisticCausalModel (PCM): A PCM provides the greatest flexibility in modeling causal mechanisms, as it only</p></li>
</ul>
<p>requires generating samples conditioned on a node’s parents. Any model that can handle conditional distributions, such
as a wide array of Bayesian models, can be employed. This class is capable of modeling rungs 1 and 2.</p>
<ul class="simple">
<li><p>StructuralCausalModel (SCM): An SCM limits mechanisms to a deterministic functional causal model (FCM) of parents and</p></li>
</ul>
<p>unobserved noise, represented as <span class="math notranslate nohighlight">\(X_i = f_i(PA_i, N_i)\)</span>, where <span class="math notranslate nohighlight">\(N_i\)</span> denotes unobserved noise. When fitting the
FCM, the model needs to be capable of accounting for the assumption that <span class="math notranslate nohighlight">\(N_i\)</span> is unobserved, but can be used as an
input when provided. A SCM generally allows modeling rungs 1 and 2, but additional constraints on the FCM are necessary
to model rung 3.</p>
<ul class="simple">
<li><p>InvertibleStructuralCausalModel (ISCM): An ISCM is an SCM that further requires the underlying FCMs of nodes to be</p></li>
</ul>
<p>invertible with respect to noise, meaning the noise can be reconstructed from the observed data. This additional
constraint reduces model flexibility but is required for modeling rung 3. With invertible models, we can address
(sample-specific) counterfactual questions. A typical example of an invertible FCM for continuous variables is an
additive noise model (ANM) of the form <span class="math notranslate nohighlight">\(X_i = f_i(PA_i, N_i) = f'_i(PA_i) + N_i\)</span>, which can be learned using
standard regression models. The noise then becomes simply the residual.</p>
<p>For causal questions like treatment effect estimation, modeling rung 2 is sufficient. On the other hand, to determine
root causes by asking “Would the target have been an outlier if node X behaved differently?”, rung 3 is required. Note
that DoWhy generally uses invertible FCMs, such as ANMs, when models are assigned automatically.</p>
</section>


              </article>
              

              
              <footer class="bd-footer-article">
                  <!-- Previous / next buttons -->
<div class='prev-next-area'>
</div>
              </footer>
              
          </div>
          
      </div>
    </div>

  
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/pydata-sphinx-theme.js?digest=92025949c220c2e29695"></script>

<footer class="bd-footer"><div class="bd-footer__inner container">
  
  <div class="footer-item">
    <p class="copyright">
    &copy; Copyright 2022, PyWhy contributors.<br>
</p>
  </div>
  
  <div class="footer-item">
    <p class="sphinx-version">
Created using <a href="http://sphinx-doc.org/">Sphinx</a> 5.3.0.<br>
</p>
  </div>
  
</div>
</footer>
  </body>
</html>