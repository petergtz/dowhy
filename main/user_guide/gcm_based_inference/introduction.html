
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-B139P18WHM"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-B139P18WHM');
</script>
    <title>Introduction &#8212; DoWhy  documentation</title>
<script>
  document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
  document.documentElement.dataset.theme = localStorage.getItem("theme") || "light"
</script>

  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=92025949c220c2e29695" rel="stylesheet">
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=92025949c220c2e29695" rel="stylesheet">


  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />

  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=92025949c220c2e29695">

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@jupyter-widgets/html-manager@^1.0.1/dist/embed-amd.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Answering Causal Questions" href="answering_causal_questions/index.html" />
    <link rel="prev" title="GCM-based inference (Experimental)" href="index.html" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta name="docsearch:language" content="en">
  </head>
  
  
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="180" data-default-mode="">
    <div class="bd-header-announcement container-fluid" id="banner">
      

    </div>

    
    <nav class="bd-header navbar navbar-light navbar-expand-lg bg-light fixed-top bd-navbar" id="navbar-main"><div class="bd-header__inner container-xl">

  <div id="navbar-start">
    
    
  


<a class="navbar-brand logo" href="../../index.html">
  
  
  
  
  
    <p class="title logo__title">DoWhy  documentation</p>
  
</a>
    
  </div>

  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-collapsible" aria-controls="navbar-collapsible" aria-expanded="false" aria-label="Toggle navigation">
    <span class="fas fa-bars"></span>
  </button>

  
  <div id="navbar-collapsible" class="col-lg-9 collapse navbar-collapse">
    <div id="navbar-center" class="mr-auto">
      
      <div class="navbar-center-item">
        <ul id="navbar-main-elements" class="navbar-nav">
    <li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../../getting_started/index.html">
  Getting started
 </a>
</li>

<li class="toctree-l1 current active nav-item">
 <a class="reference internal nav-link" href="../index.html">
  User Guide
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../../example_notebooks/nb_index.html">
  Examples
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../../dowhy.html">
  API reference
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../../contributing.html">
  Contributing
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../../code_repo.html">
  Release notes
 </a>
</li>

    
</ul>
      </div>
      
    </div>

    <div id="navbar-end">
      
      <div class="navbar-end-item">
        <ul id="navbar-icon-links" class="navbar-nav" aria-label="Icon Links">
      </ul>
      </div>
      
      <div class="navbar-end-item">
        
<div class="dropdown" id="version_switcher">
    <button type="button" class="btn btn-sm navbar-btn dropdown-toggle" id="version_switcher_button" data-toggle="dropdown">
        main-branch
        <span class="caret"></span>
    </button>
    <div id="version_switcher_menu" class="dropdown-menu list-group-flush py-0" aria-labelledby="version_switcher_button">
        <dl>
            <dt>Releases</dt>
            <!-- hard-coding the old versions, as no further old version will be added -->
            <!-- It would be nice if this opened the same page in an older version, but that seems to be overkill
                 right now. Therefore defaulting to the starting page (index). -->
            <dd><a href="/dowhy/v0.8/index.html">v0.8</a></dd>
            <dd><a href="/dowhy/v0.7.1/index.html">v0.7.1</a></dd>
            <dd><a href="/dowhy/v0.7/index.html">v0.7</a></dd>
            <dd><a href="/dowhy/v0.6/index.html">v0.6</a></dd>
            <dd><a href="/dowhy/v0.5.1/index.html">v0.5.1</a></dd>
            <dd><a href="/dowhy/v0.5/index.html">v0.5</a></dd>
            <dd><a href="/dowhy/v0.4/index.html">v0.4</a></dd>
            <dd><a href="/dowhy/v0.2/index.html">v0.2</a></dd>
            <dd><a href="/dowhy/v0.1.1-alpha/index.html">v0.1.1-alpha</a></dd>
            <dd><a href="/dowhy/v0.1-alpha/index.html">v0.1-alpha</a></dd>
        </dl>
        <dl>
            <dt>Branches</dt>
            <dd><a href="introduction.html">main</a></dd>
        </dl>
    </div>
</div>
      </div>
      
    </div>
  </div>
</div>
    </nav>
    

    <div class="bd-container container-xl">
      <div class="bd-container__inner row">
          

<!-- Only show if we have sidebars configured, else just a small margin  -->
<div class="bd-sidebar-primary col-12 col-md-3 bd-sidebar">
  <div class="sidebar-start-items"><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <div class="bd-toc-item active">
    <ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../intro.html">
   Introduction to DoWhy
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../effect_inference/index.html">
   Effect inference
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../effect_inference/model.html">
     1. Model a causal problem
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../effect_inference/identify.html">
     2. Identify a target estimand under the model
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../effect_inference/estimate.html">
     3. Estimate causal effect based on the identified estimand
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../effect_inference/refute.html">
     4. Refute the obtained estimate
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="index.html">
   GCM-based inference (Experimental)
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     Introduction
    </a>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="answering_causal_questions/index.html">
     Answering Causal Questions
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
    <label for="toctree-checkbox-3">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="answering_causal_questions/quantify_arrow_strength.html">
       Quantifying Arrow Strength
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="answering_causal_questions/quantify_intrinsic_causal_influence.html">
       Quantifying Intrinsic Causal Influence
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="answering_causal_questions/simulate_impact_of_interventions.html">
       Simulating the Impact of Interventions
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="answering_causal_questions/computing_counterfactuals.html">
       Computing Counterfactuals
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="answering_causal_questions/average_causal_effect.html">
       Estimating Average Causal Effects
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="answering_causal_questions/attribute_distributional_changes.html">
       Attributing Distributional Changes
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="draw_samples.html">
     Generate samples from a GCM
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="customizing_model_assignment.html">
     Customizing Causal Mechanism Assignment
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="estimating_confidence_intervals.html">
     Estimating Confidence Intervals
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="independence_tests.html">
     Independence Tests
    </a>
   </li>
  </ul>
 </li>
</ul>

  </div>
</nav>
  </div>
  <div class="sidebar-end-items">
  </div>
</div>


          


<div class="bd-sidebar-secondary d-none d-xl-block col-xl-2 bd-toc">
  
    
    <div class="toc-item">
      
<div class="tocsection onthispage mt-5 pt-1 pb-3">
    <i class="fas fa-list"></i> On this page
</div>

<nav id="bd-toc-nav">
    <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#the-basic-building-blocks">
   The basic building blocks
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#step-1-modeling-cause-effect-relationships-as-a-structural-causal-model-scm">
     Step 1: Modeling cause-effect relationships as a structural causal model (SCM)
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#step-2-fitting-the-scm-to-the-data">
     Step 2: Fitting the SCM to the data
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#step-3-answering-a-causal-query-based-on-the-scm">
     Step 3: Answering a causal query based on the SCM
    </a>
   </li>
  </ul>
 </li>
</ul>

</nav>
    </div>
    
    <div class="toc-item">
      
    </div>
    
  
</div>


          
          
          <div class="bd-content col-12 col-md-9 col-xl-7">
              
              <article class="bd-article" role="main">
                
  <section id="introduction">
<h1>Introduction<a class="headerlink" href="#introduction" title="Permalink to this heading"></a></h1>
<p>Graphical causal model-based inference, or GCM-based inference for short, is an experimental addition to DoWhy, that
currently works separately from DoWhy’s main API. Its experimental status also means that its API may
undergo breaking changes in the future. It will be forming a part of a joint,
<a class="reference external" href="https://github.com/py-why/dowhy/wiki/API-proposal-for-v1">new API</a>. We welcome your comments.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">dowhy.gcm</span></code> package provides a variety of ways to answer causal questions and we’ll go through them in detail in
section <a class="reference internal" href="answering_causal_questions/index.html"><span class="doc">Answering Causal Questions</span></a>. However, before diving into them, let’s understand
the basic building blocks and usage patterns it is built upon.</p>
<p>If you find the gcm package useful for your work, please cite us as follows:</p>
<p>Bibtex:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@article</span><span class="p">{</span><span class="n">dowhy_gcm</span><span class="p">,</span>
  <span class="n">author</span> <span class="o">=</span> <span class="p">{</span><span class="n">Bl</span><span class="p">{</span>\<span class="s2">&quot;o}baum, Patrick and G{</span><span class="se">\&quot;</span><span class="s2">o}tz, Peter and Budhathoki, Kailash and Mastakouri, Atalanti A. and Janzing, Dominik},</span>
  <span class="n">title</span> <span class="o">=</span> <span class="p">{</span><span class="n">DoWhy</span><span class="o">-</span><span class="n">GCM</span><span class="p">:</span> <span class="n">An</span> <span class="n">extension</span> <span class="n">of</span> <span class="n">DoWhy</span> <span class="k">for</span> <span class="n">causal</span> <span class="n">inference</span> <span class="ow">in</span> <span class="n">graphical</span> <span class="n">causal</span> <span class="n">models</span><span class="p">},</span>
  <span class="n">journal</span><span class="o">=</span><span class="p">{</span><span class="n">arXiv</span> <span class="n">preprint</span> <span class="n">arXiv</span><span class="p">:</span><span class="mf">2206.06821</span><span class="p">},</span>
  <span class="n">year</span><span class="o">=</span><span class="p">{</span><span class="mi">2022</span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<section id="the-basic-building-blocks">
<h2>The basic building blocks<a class="headerlink" href="#the-basic-building-blocks" title="Permalink to this heading"></a></h2>
<p>All main features of the GCM-based inference in DoWhy are built around the concept of <strong>graphical causal models</strong>. A
graphical causal model consists of a causal direct acyclic graph (DAG) of variables and a <strong>causal mechanism</strong> for
each of the variables. A causal mechanism defines the conditional distribution of a variable given its parents in the
graph, or, in case of root node variables, simply its distribution.</p>
<p>The most general case of a GCM is a <strong>probabilistic causal model</strong> (PCM), where causal mechanisms are defined by
<strong>conditional stochastic models</strong> and <strong>stochastic models</strong>. In the <code class="docutils literal notranslate"><span class="pre">dowhy.gcm</span></code> package, these are represented by
<code class="xref py py-class docutils literal notranslate"><span class="pre">ProbabilisticCausalModel</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">ConditionalStochasticModel</span></code>, and <code class="xref py py-class docutils literal notranslate"><span class="pre">StochasticModel</span></code>.</p>
<a class="reference internal image-reference" href="../../_images/pcm.png"><img alt="../../_images/pcm.png" class="align-center" src="../../_images/pcm.png" style="width: 80%;" /></a>
<div class="line-block">
<div class="line"><br /></div>
</div>
<p>In practical terms however, we often use <strong>structural causal models</strong> (SCMs) to represent our GCMs,
and the causal mechanisms are defined by <strong>functional causal models</strong> (FCMs) for non-root nodes and <strong>stochastic
models</strong> for root nodes. An SCM implements the same traits as a PCM, but on top of that, its FCMs allow us to
reason <em>further</em> about its data generation process based on parents and noise, and hence, allow us e.g. to compute
counterfactuals.</p>
<a class="reference internal image-reference" href="../../_images/scm.png"><img alt="../../_images/scm.png" class="align-center" src="../../_images/scm.png" style="width: 80%;" /></a>
<div class="line-block">
<div class="line"><br /></div>
</div>
<p>To keep this introduction simple, we will stick with SCMs for now.</p>
<p>As mentioned above, a causal mechanism describes how the values of a node are influenced by the values of its parent
nodes. We will dive much deeper into the details of causal mechanisms and their meaning in section
<a class="reference internal" href="customizing_model_assignment.html"><span class="doc">Customizing Causal Mechanism Assignment</span></a>. But for this introduction, we will treat them as an opaque thing that is needed
to answer causal questions. With that in mind, the typical steps involved in answering a causal question, are:</p>
<p>1. <strong>Modeling cause-effect relationships as a GCM (causal graph + causal mechanisms):</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">causal_model</span> <span class="o">=</span> <span class="n">StructuralCausalModel</span><span class="p">(</span><span class="n">nx</span><span class="o">.</span><span class="n">DiGraph</span><span class="p">([(</span><span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="s1">&#39;Y&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;Y&#39;</span><span class="p">,</span> <span class="s1">&#39;Z&#39;</span><span class="p">)]))</span> <span class="c1"># X -&gt; Y -&gt; Z</span>
<span class="n">auto</span><span class="o">.</span><span class="n">assign_causal_mechanisms</span><span class="p">(</span><span class="n">causal_model</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
</pre></div>
</div>
<p>Or manually assign causal mechanisms:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">causal_model</span><span class="o">.</span><span class="n">set_causal_mechanism</span><span class="p">(</span><span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="n">EmpiricalDistribution</span><span class="p">())</span>
<span class="n">causal_model</span><span class="o">.</span><span class="n">set_causal_mechanism</span><span class="p">(</span><span class="s1">&#39;Y&#39;</span><span class="p">,</span> <span class="n">AdditiveNoiseModel</span><span class="p">(</span><span class="n">create_linear_regressor</span><span class="p">()))</span>
<span class="n">causal_model</span><span class="o">.</span><span class="n">set_causal_mechanism</span><span class="p">(</span><span class="s1">&#39;Z&#39;</span><span class="p">,</span> <span class="n">AdditiveNoiseModel</span><span class="p">(</span><span class="n">create_linear_regressor</span><span class="p">()))</span>
</pre></div>
</div>
<p>2. <strong>Fitting the GCM to the data:</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">fit</span><span class="p">(</span><span class="n">causal_model</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
</pre></div>
</div>
<p>3. <strong>Answering a causal query based on the GCM:</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">results</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">causal_query</span><span class="o">&gt;</span><span class="p">(</span><span class="n">causal_model</span><span class="p">,</span> <span class="o">...</span><span class="p">)</span>
</pre></div>
</div>
<p>Where <code class="docutils literal notranslate"><span class="pre">&lt;causal_query&gt;</span></code> can be one of multiple functions explained in
<a class="reference internal" href="answering_causal_questions/index.html"><span class="doc">Answering Causal Questions</span></a>.</p>
<p>Let’s look at each of these steps in more detail.</p>
<section id="step-1-modeling-cause-effect-relationships-as-a-structural-causal-model-scm">
<h3>Step 1: Modeling cause-effect relationships as a structural causal model (SCM)<a class="headerlink" href="#step-1-modeling-cause-effect-relationships-as-a-structural-causal-model-scm" title="Permalink to this heading"></a></h3>
<p>The first step is to model the cause-effect relationships between variables relevant
to our use case. We do that in form of a causal graph. A causal graph is a directed acyclic
graph (DAG) where an edge X→Y implies that X causes Y. Statistically, a causal graph encodes the
conditional independence relations between variables. Using the <a class="reference external" href="https://networkx.github.io/">networkx</a> library, we can create causal graphs. In the snippet below, we create a chain
X→Y→Z:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">networkx</span> <span class="k">as</span> <span class="nn">nx</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">causal_graph</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">DiGraph</span><span class="p">([(</span><span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="s1">&#39;Y&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;Y&#39;</span><span class="p">,</span> <span class="s1">&#39;Z&#39;</span><span class="p">)])</span>
</pre></div>
</div>
<p>To answer causal questions using causal graphs, we also have to know the nature of underlying
data-generating process of variables. A causal graph by itself, being a diagram, does not have
any information about the data-generating process. To introduce this data-generating process, we use an SCM that’s
built on top of our causal graph:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">dowhy</span> <span class="kn">import</span> <span class="n">gcm</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">causal_model</span> <span class="o">=</span> <span class="n">gcm</span><span class="o">.</span><span class="n">StructuralCausalModel</span><span class="p">(</span><span class="n">causal_graph</span><span class="p">)</span>
</pre></div>
</div>
<p>At this point we would normally load our dataset. For this introduction, we generate
some synthetic data instead. The API takes data in form of Pandas DataFrames:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span><span class="o">,</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Y</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">X</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Z</span> <span class="o">=</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">Y</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">X</span><span class="o">=</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="o">=</span><span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="o">=</span><span class="n">Z</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
<span class="go">          X         Y          Z</span>
<span class="go">0 -2.253500 -3.638579 -10.370047</span>
<span class="go">1 -1.078337 -2.114581  -6.028030</span>
<span class="go">2 -0.962719 -2.157896  -5.750563</span>
<span class="go">3 -0.300316 -0.440721  -2.619954</span>
<span class="go">4  0.127419  0.158185   1.555927</span>
</pre></div>
</div>
<p>Note how the columns X, Y, Z correspond to our nodes X, Y, Z in the graph constructed above. We can also see how the
values of X influence the values of Y and how the values of Y influence the values of Z in that data set.</p>
<p>The causal model created above allows us now to assign causal mechanisms to each node in the form of functional causal
models. Here, these mechanism can either be assigned manually if, for instance, prior knowledge about certain causal
relationships are known or they can be assigned automatically using the <a class="reference internal" href="../../dowhy.gcm.html#module-dowhy.gcm.auto" title="dowhy.gcm.auto"><code class="xref py py-mod docutils literal notranslate"><span class="pre">auto</span></code></a> module. For the latter,
we simply call:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">gcm</span><span class="o">.</span><span class="n">auto</span><span class="o">.</span><span class="n">assign_causal_mechanisms</span><span class="p">(</span><span class="n">causal_model</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
</pre></div>
</div>
<p>In case we want to have more control over the assigned mechanisms, we can do this manually as well. For instance, we can
can assign an empirical distribution to the root node X and linear additive noise models to nodes Y and Z:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">causal_model</span><span class="o">.</span><span class="n">set_causal_mechanism</span><span class="p">(</span><span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="n">gcm</span><span class="o">.</span><span class="n">EmpiricalDistribution</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">causal_model</span><span class="o">.</span><span class="n">set_causal_mechanism</span><span class="p">(</span><span class="s1">&#39;Y&#39;</span><span class="p">,</span> <span class="n">gcm</span><span class="o">.</span><span class="n">AdditiveNoiseModel</span><span class="p">(</span><span class="n">gcm</span><span class="o">.</span><span class="n">ml</span><span class="o">.</span><span class="n">create_linear_regressor</span><span class="p">()))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">causal_model</span><span class="o">.</span><span class="n">set_causal_mechanism</span><span class="p">(</span><span class="s1">&#39;Z&#39;</span><span class="p">,</span> <span class="n">gcm</span><span class="o">.</span><span class="n">AdditiveNoiseModel</span><span class="p">(</span><span class="n">gcm</span><span class="o">.</span><span class="n">ml</span><span class="o">.</span><span class="n">create_linear_regressor</span><span class="p">()))</span>
</pre></div>
</div>
<p>Section <a class="reference internal" href="customizing_model_assignment.html"><span class="doc">Customizing Causal Mechanism Assignment</span></a> will go into more detail on how one can even define a completely customized
model or add their own implementation.</p>
<p>In the real world, the data comes as an opaque stream of values, where we typically don’t know how one
variable influences another. The graphical causal models can help us to deconstruct these causal
relationships again, even though we didn’t know them before.</p>
</section>
<section id="step-2-fitting-the-scm-to-the-data">
<h3>Step 2: Fitting the SCM to the data<a class="headerlink" href="#step-2-fitting-the-scm-to-the-data" title="Permalink to this heading"></a></h3>
<p>With the data at hand and the graph constructed earlier, we can now train the SCM using <code class="docutils literal notranslate"><span class="pre">fit</span></code>:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">gcm</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">causal_model</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
</pre></div>
</div>
<p>Fitting means, we learn the generative models of the variables in the SCM according to the data.</p>
</section>
<section id="step-3-answering-a-causal-query-based-on-the-scm">
<h3>Step 3: Answering a causal query based on the SCM<a class="headerlink" href="#step-3-answering-a-causal-query-based-on-the-scm" title="Permalink to this heading"></a></h3>
<p>The last step, answering a causal question, is our actual goal. E.g. we could ask the question:</p>
<blockquote>
<div><p>What will happen to the variable Z if I intervene on Y?</p>
</div></blockquote>
<p>This can be done via the <code class="docutils literal notranslate"><span class="pre">interventional_samples</span></code> function. Here’s how:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">samples</span> <span class="o">=</span> <span class="n">gcm</span><span class="o">.</span><span class="n">interventional_samples</span><span class="p">(</span><span class="n">causal_model</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                                     <span class="p">{</span><span class="s1">&#39;Y&#39;</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">y</span><span class="p">:</span> <span class="mf">2.34</span> <span class="p">},</span>
<span class="gp">&gt;&gt;&gt; </span>                                     <span class="n">num_samples_to_draw</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">samples</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
<span class="go">          X         Y          Z</span>
<span class="go">0  1.186229  6.918607  20.682375</span>
<span class="go">1 -0.758809 -0.749365  -2.530045</span>
<span class="go">2 -1.177379 -5.678514 -17.110836</span>
<span class="go">3 -1.211356 -2.152073  -6.212703</span>
<span class="go">4 -0.100224 -0.285047   0.256471</span>
</pre></div>
</div>
<p>This intervention says: “I’ll ignore any causal effects of X on Y, and set every value of Y
to 2.34.” So the distribution of X will remain unchanged, whereas values of Y will be at a fixed
value and Z will respond according to its causal model.</p>
<p>With this knowledge, we can now dive deep into the meaning and usages of causal queries in section
<a class="reference internal" href="answering_causal_questions/index.html"><span class="doc">Answering Causal Questions</span></a>.</p>
</section>
</section>
</section>


              </article>
              

              
              <footer class="bd-footer-article">
                  <!-- Previous / next buttons -->
<div class='prev-next-area'>
  <a class='left-prev' id="prev-link" href="index.html" title="previous page">
      <i class="fas fa-angle-left"></i>
      <div class="prev-next-info">
          <p class="prev-next-subtitle">previous</p>
          <p class="prev-next-title">GCM-based inference (Experimental)</p>
      </div>
  </a>
  <a class='right-next' id="next-link" href="answering_causal_questions/index.html" title="next page">
  <div class="prev-next-info">
      <p class="prev-next-subtitle">next</p>
      <p class="prev-next-title">Answering Causal Questions</p>
  </div>
  <i class="fas fa-angle-right"></i>
  </a>
</div>
              </footer>
              
          </div>
          
      </div>
    </div>

  
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/pydata-sphinx-theme.js?digest=92025949c220c2e29695"></script>

<footer class="bd-footer"><div class="bd-footer__inner container">
  
  <div class="footer-item">
    <p class="copyright">
    &copy; Copyright 2022, PyWhy contributors.<br>
</p>
  </div>
  
  <div class="footer-item">
    <p class="sphinx-version">
Created using <a href="http://sphinx-doc.org/">Sphinx</a> 5.1.1.<br>
</p>
  </div>
  
</div>
</footer>
  </body>
</html>